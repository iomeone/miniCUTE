<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.HsColour.Classify</span><span>
</span><a name="line-2"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#tokenise"><span class="hs-identifier hs-var">tokenise</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSpace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isUpper</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isLower</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">-- | Lex Haskell source code into an annotated token stream, without</span><span>
</span><a name="line-10"></a><span class="hs-comment">--   discarding any characters or layout.</span><span>
</span><a name="line-11"></a><span class="hs-identifier">tokenise</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-12"></a><a name="tokenise"><a href="Language.Haskell.HsColour.Classify.html#tokenise"><span class="hs-identifier">tokenise</span></a></a><span> </span><a name="local-6989586621679025428"><a href="#local-6989586621679025428"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679025429"><a href="#local-6989586621679025429"><span class="hs-identifier">chunks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679025428"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#markDefs"><span class="hs-identifier hs-var">markDefs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679025430"><a href="#local-6989586621679025430"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#classify"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679025430"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621679025430"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025429"><span class="hs-identifier hs-var">chunks</span></a><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-identifier">markDefs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-17"></a><a name="markDefs"><a href="Language.Haskell.HsColour.Classify.html#markDefs"><span class="hs-identifier">markDefs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-18"></a><span class="hs-identifier">markDefs</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Varid"><span class="hs-identifier hs-var">Varid</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025431"><a href="#local-6989586621679025431"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679025432"><a href="#local-6989586621679025432"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Definition"><span class="hs-identifier hs-var">Definition</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025431"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#continue"><span class="hs-identifier hs-var">continue</span></a><span> </span><a href="#local-6989586621679025432"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-19"></a><span class="hs-identifier">markDefs</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Varop"><span class="hs-identifier hs-var">Varop</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Varid"><span class="hs-identifier hs-var">Varid</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025433"><a href="#local-6989586621679025433"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679025434"><a href="#local-6989586621679025434"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Varop"><span class="hs-identifier hs-var">Varop</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Definition"><span class="hs-identifier hs-var">Definition</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025433"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#continue"><span class="hs-identifier hs-var">continue</span></a><span> </span><a href="#local-6989586621679025434"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-21"></a><span class="hs-identifier">markDefs</span><span> </span><a name="local-6989586621679025435"><a href="#local-6989586621679025435"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#continue"><span class="hs-identifier hs-var">continue</span></a><span> </span><a href="#local-6989586621679025435"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><a name="continue"><a href="Language.Haskell.HsColour.Classify.html#continue"><span class="hs-identifier">continue</span></a></a><span> </span><a name="local-6989586621679025436"><a href="#local-6989586621679025436"><span class="hs-identifier">rest</span></a></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025437"><a href="#local-6989586621679025437"><span class="hs-identifier">thisLine</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025438"><a href="#local-6989586621679025438"><span class="hs-identifier">nextLine</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025436"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-25"></a><span>      </span><span class="hs-keyword">in</span><span>
</span><a name="line-26"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679025438"><span class="hs-identifier hs-var">nextLine</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-27"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025437"><span class="hs-identifier hs-var">thisLine</span></a><span>
</span><a name="line-28"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679025632"><a href="#local-6989586621679025632"><span class="hs-identifier">nextLine'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025437"><span class="hs-identifier hs-var">thisLine</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="Language.Haskell.HsColour.Classify.html#markDefs"><span class="hs-identifier hs-var">markDefs</span></a><span> </span><a href="#local-6989586621679025632"><span class="hs-identifier hs-var">nextLine'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- Basic Haskell lexing, except we keep whitespace.</span><span>
</span><a name="line-32"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-33"></a><a name="chunk"><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier">chunk</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-34"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\r'</span><span class="hs-glyph">:</span><a name="local-6989586621679025633"><a href="#local-6989586621679025633"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679025633"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-comment">-- get rid of DOS newline stuff</span><span>
</span><a name="line-35"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><a name="local-6989586621679025634"><a href="#local-6989586621679025634"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679025634"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-36"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025635"><a href="#local-6989586621679025635"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025636"><a href="#local-6989586621679025636"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#isLinearSpace"><span class="hs-identifier hs-var">isLinearSpace</span></a><span> </span><a href="#local-6989586621679025635"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-37"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025635"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025637"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679025638"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025637"><a href="#local-6989586621679025637"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><a name="local-6989586621679025638"><a href="#local-6989586621679025638"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#isLinearSpace"><span class="hs-identifier hs-var">isLinearSpace</span></a><span> </span><a href="#local-6989586621679025636"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-38"></a><span class="hs-identifier">chunk</span><span> </span><span class="hs-special">(</span><span class="hs-char">'{'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-6989586621679025639"><a href="#local-6989586621679025639"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025640"><a href="#local-6989586621679025640"><span class="hs-identifier">com</span></a></a><span class="hs-special">,</span><a name="local-6989586621679025641"><a href="#local-6989586621679025641"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#nestcomment"><span class="hs-identifier hs-var">nestcomment</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679025639"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-39"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-char">'{'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a href="#local-6989586621679025640"><span class="hs-identifier hs-var">com</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679025641"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-40"></a><span class="hs-identifier">chunk</span><span> </span><a name="local-6989586621679025642"><a href="#local-6989586621679025642"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Prelude.lex</span><span> </span><a href="#local-6989586621679025642"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-41"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679025642"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679025642"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- e.g. inside comment</span><span>
</span><a name="line-42"></a><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679026682"><a href="#local-6989586621679026682"><span class="hs-identifier">tok</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679026683"><a href="#local-6989586621679026683"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-char">'-'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026682"><span class="hs-identifier hs-var">tok</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026682"><span class="hs-identifier hs-var">tok</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679026684"><span class="hs-identifier hs-var">com</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679026685"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-44"></a><span>                                       </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679026684"><a href="#local-6989586621679026684"><span class="hs-identifier">com</span></a></a><span class="hs-special">,</span><a name="local-6989586621679026685"><a href="#local-6989586621679026685"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#eolcomment"><span class="hs-identifier hs-var">eolcomment</span></a><span> </span><a href="#local-6989586621679026683"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-45"></a><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679027831"><a href="#local-6989586621679027831"><span class="hs-identifier">tok</span></a></a><span class="hs-special">,</span><a name="local-6989586621679027832"><a href="#local-6989586621679027832"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679027831"><span class="hs-identifier hs-var">tok</span></a><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#chunk"><span class="hs-identifier hs-var">chunk</span></a><span> </span><a href="#local-6989586621679027832"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><a name="isLinearSpace"><a href="Language.Haskell.HsColour.Classify.html#isLinearSpace"><span class="hs-identifier">isLinearSpace</span></a></a><span> </span><a name="local-6989586621679027833"><a href="#local-6989586621679027833"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679027833"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot; \t\f&quot;</span><span> </span><span class="hs-comment">-- &quot; \t\xa0&quot;</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- Glue sequences of tokens into more useful blobs</span><span>
</span><a name="line-50"></a><a name="glue"><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier">glue</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679027834"><a href="#local-6989586621679027834"><span class="hs-identifier">q</span></a></a><span class="hs-glyph">:</span><span class="hs-string">&quot;.&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679027835"><a href="#local-6989586621679027835"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679027836"><a href="#local-6989586621679027836"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isUpper</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679027834"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- qualified names</span><span>
</span><a name="line-51"></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679027834"><span class="hs-identifier hs-var">q</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;.&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679027835"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679027836"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;`&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028145"><a href="#local-6989586621679028145"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>                               </span><span class="hs-comment">-- `varid` -&gt; varop</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028145"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679028146"><a href="#local-6989586621679028146"><span class="hs-identifier">qn</span></a></a><span class="hs-glyph">:</span><span class="hs-string">&quot;`&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028147"><a href="#local-6989586621679028147"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;`&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679028146"><span class="hs-identifier hs-var">qn</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;`&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028147"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;`&quot;</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028145"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-56"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028148"><a href="#local-6989586621679028148"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028149"><a href="#local-6989586621679028149"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-char">'-'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028148"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679028148"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span class="hs-number">2</span><span>       </span><span class="hs-comment">-- eol comment</span><span>
</span><a name="line-57"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028148"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679028150"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028151"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-58"></a><span>                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028150"><a href="#local-6989586621679028150"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028151"><a href="#local-6989586621679028151"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028149"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-59"></a><span class="hs-comment">--glue (&quot;{&quot;:&quot;-&quot;:ss)  = (&quot;{-&quot;++c): glue rest	-- nested comment</span><span>
</span><a name="line-60"></a><span class="hs-comment">--                  where (c,rest) = nestcomment 0 ss</span><span>
</span><a name="line-61"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028152"><a href="#local-6989586621679028152"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679028154"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-62"></a><span>                </span><span class="hs-string">&quot;)&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028155"><a href="#local-6989586621679028155"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679028153"><span class="hs-identifier hs-var">tuple</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028155"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-63"></a><span>                </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028152"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-64"></a><span>              </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028153"><a href="#local-6989586621679028153"><span class="hs-identifier">tuple</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028154"><a href="#local-6989586621679028154"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028152"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;[&quot;</span><span class="hs-glyph">:</span><span class="hs-string">&quot;]&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028156"><a href="#local-6989586621679028156"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;[]&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028156"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-66"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;\n&quot;</span><span class="hs-glyph">:</span><span class="hs-string">&quot;#&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679028157"><a href="#local-6989586621679028157"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="hs-char">'#'</span><span class="hs-glyph">:</span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679028158"><span class="hs-identifier hs-var">line</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028159"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-67"></a><span>                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028158"><a href="#local-6989586621679028158"><span class="hs-identifier">line</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028159"><a href="#local-6989586621679028159"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028157"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-68"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028160"><a href="#local-6989586621679028160"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028161"><a href="#local-6989586621679028161"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679028160"><span class="hs-identifier hs-var">s</span></a><span class="hs-glyph">:</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#glue"><span class="hs-identifier hs-var">glue</span></a><span> </span><a href="#local-6989586621679028161"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-69"></a><span class="hs-identifier">glue</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- Deal with comments.</span><span>
</span><a name="line-72"></a><span class="hs-identifier">nestcomment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><a name="nestcomment"><a href="Language.Haskell.HsColour.Classify.html#nestcomment"><span class="hs-identifier">nestcomment</span></a></a><span> </span><a name="local-6989586621679028162"><a href="#local-6989586621679028162"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'{'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-6989586621679028163"><a href="#local-6989586621679028163"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028162"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">&gt;=</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-string">&quot;{-&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679028164"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679028165"><span class="hs-identifier hs-var">rm</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>                                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028164"><a href="#local-6989586621679028164"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028165"><a href="#local-6989586621679028165"><span class="hs-identifier">rm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#nestcomment"><span class="hs-identifier hs-var">nestcomment</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028162"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028163"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-75"></a><span class="hs-identifier">nestcomment</span><span> </span><a name="local-6989586621679028246"><a href="#local-6989586621679028246"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-char">'}'</span><span class="hs-glyph">:</span><a name="local-6989586621679028247"><a href="#local-6989586621679028247"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028246"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">&gt;</span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-string">&quot;-}&quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679028248"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679028249"><span class="hs-identifier hs-var">rm</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>                                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028248"><a href="#local-6989586621679028248"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028249"><a href="#local-6989586621679028249"><span class="hs-identifier">rm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#nestcomment"><span class="hs-identifier hs-var">nestcomment</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028246"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028247"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-77"></a><span class="hs-identifier">nestcomment</span><span> </span><a name="local-6989586621679028250"><a href="#local-6989586621679028250"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><span class="hs-char">'}'</span><span class="hs-glyph">:</span><a name="local-6989586621679028251"><a href="#local-6989586621679028251"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028250"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;-}&quot;</span><span class="hs-special">,</span><a href="#local-6989586621679028251"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span class="hs-identifier">nestcomment</span><span> </span><a name="local-6989586621679028252"><a href="#local-6989586621679028252"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679028253"><a href="#local-6989586621679028253"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028254"><a href="#local-6989586621679028254"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028252"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">&gt;=</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679028253"><span class="hs-identifier hs-var">s</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679028255"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679028256"><span class="hs-identifier hs-var">rm</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>                                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028255"><a href="#local-6989586621679028255"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028256"><a href="#local-6989586621679028256"><span class="hs-identifier">rm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#nestcomment"><span class="hs-identifier hs-var">nestcomment</span></a><span> </span><a href="#local-6989586621679028252"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679028254"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-80"></a><span class="hs-identifier">nestcomment</span><span> </span><a name="local-6989586621679028257"><a href="#local-6989586621679028257"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">eolcomment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><a name="eolcomment"><a href="Language.Haskell.HsColour.Classify.html#eolcomment"><span class="hs-identifier">eolcomment</span></a></a><span> </span><a name="local-6989586621679028258"><a href="#local-6989586621679028258"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-char">'\n'</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679028258"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span class="hs-identifier">eolcomment</span><span> </span><span class="hs-special">(</span><span class="hs-char">'\r'</span><span class="hs-glyph">:</span><a name="local-6989586621679028259"><a href="#local-6989586621679028259"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#eolcomment"><span class="hs-identifier hs-var">eolcomment</span></a><span> </span><a href="#local-6989586621679028259"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-85"></a><span class="hs-identifier">eolcomment</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028260"><a href="#local-6989586621679028260"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028261"><a href="#local-6989586621679028261"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028260"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679028262"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679028263"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679028262"><a href="#local-6989586621679028262"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679028263"><a href="#local-6989586621679028263"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#eolcomment"><span class="hs-identifier hs-var">eolcomment</span></a><span> </span><a href="#local-6989586621679028261"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-86"></a><span class="hs-identifier">eolcomment</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Classification of tokens as lexical entities</span><span>
</span><a name="line-89"></a><span class="hs-keyword">data</span><span> </span><a name="TokenType"><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier">TokenType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>  </span><a name="Space"><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier">Space</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Keyword"><a href="Language.Haskell.HsColour.Classify.html#Keyword"><span class="hs-identifier">Keyword</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Keyglyph"><a href="Language.Haskell.HsColour.Classify.html#Keyglyph"><span class="hs-identifier">Keyglyph</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Layout"><a href="Language.Haskell.HsColour.Classify.html#Layout"><span class="hs-identifier">Layout</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Comment"><a href="Language.Haskell.HsColour.Classify.html#Comment"><span class="hs-identifier">Comment</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Conid"><a href="Language.Haskell.HsColour.Classify.html#Conid"><span class="hs-identifier">Conid</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Varid"><a href="Language.Haskell.HsColour.Classify.html#Varid"><span class="hs-identifier">Varid</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-91"></a><span>  </span><a name="Conop"><a href="Language.Haskell.HsColour.Classify.html#Conop"><span class="hs-identifier">Conop</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Varop"><a href="Language.Haskell.HsColour.Classify.html#Varop"><span class="hs-identifier">Varop</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="String"><a href="Language.Haskell.HsColour.Classify.html#String"><span class="hs-identifier">String</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Char"><a href="Language.Haskell.HsColour.Classify.html#Char"><span class="hs-identifier">Char</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Number"><a href="Language.Haskell.HsColour.Classify.html#Number"><span class="hs-identifier">Number</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cpp"><a href="Language.Haskell.HsColour.Classify.html#Cpp"><span class="hs-identifier">Cpp</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Error"><a href="Language.Haskell.HsColour.Classify.html#Error"><span class="hs-identifier">Error</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-92"></a><span>  </span><a name="Definition"><a href="Language.Haskell.HsColour.Classify.html#Definition"><span class="hs-identifier">Definition</span></a></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a><span>
</span><a name="line-96"></a><a name="classify"><a href="Language.Haskell.HsColour.Classify.html#classify"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679028264"><a href="#local-6989586621679028264"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679028265"><a href="#local-6989586621679028265"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679028266"><a href="#local-6989586621679028266"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-char">'-'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;--&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-100"></a><span>      </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span>          </span><span class="hs-comment">-- not fully correct</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;{-&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#keywords"><span class="hs-identifier hs-var">keywords</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Keyword"><span class="hs-identifier hs-var">Keyword</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#keyglyphs"><span class="hs-identifier hs-var">keyglyphs</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Keyglyph"><span class="hs-identifier hs-var">Keyglyph</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#layoutchars"><span class="hs-identifier hs-var">layoutchars</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Layout"><span class="hs-identifier hs-var">Layout</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isUpper</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Conid"><span class="hs-identifier hs-var">Conid</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028264"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;[]&quot;</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Conid"><span class="hs-identifier hs-var">Conid</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#isTupleTail"><span class="hs-identifier hs-var">isTupleTail</span></a><span> </span><a href="#local-6989586621679028266"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Conid"><span class="hs-identifier hs-var">Conid</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'#'</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Cpp"><span class="hs-identifier hs-var">Cpp</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isLower</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Varid"><span class="hs-identifier hs-var">Varid</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#symbols"><span class="hs-identifier hs-var">symbols</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Varop"><span class="hs-identifier hs-var">Varop</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">==</span><span class="hs-char">':'</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Conop"><span class="hs-identifier hs-var">Conop</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">==</span><span class="hs-char">'`'</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Varop"><span class="hs-identifier hs-var">Varop</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">==</span><span class="hs-char">'&quot;'</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#String"><span class="hs-identifier hs-var">String</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">==</span><span class="hs-char">'\''</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Char"><span class="hs-identifier hs-var">Char</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span> </span><a href="#local-6989586621679028265"><span class="hs-identifier hs-var">h</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Number"><span class="hs-identifier hs-var">Number</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Error"><span class="hs-identifier hs-var">Error</span></a><span>
</span><a name="line-117"></a><span class="hs-identifier">classify</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#Space"><span class="hs-identifier hs-var">Space</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><a name="isTupleTail"><a href="Language.Haskell.HsColour.Classify.html#isTupleTail"><span class="hs-identifier">isTupleTail</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-char">')'</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-120"></a><span class="hs-identifier">isTupleTail</span><span> </span><span class="hs-special">(</span><span class="hs-char">','</span><span class="hs-glyph">:</span><a name="local-6989586621679028424"><a href="#local-6989586621679028424"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.Haskell.HsColour.Classify.html#isTupleTail"><span class="hs-identifier hs-var">isTupleTail</span></a><span> </span><a href="#local-6989586621679028424"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">isTupleTail</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- Haskell keywords</span><span>
</span><a name="line-125"></a><a name="keywords"><a href="Language.Haskell.HsColour.Classify.html#keywords"><span class="hs-identifier">keywords</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">[</span><span class="hs-string">&quot;case&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;class&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;data&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;default&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;deriving&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;do&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;else&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;forall&quot;</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-special">,</span><span class="hs-string">&quot;if&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;import&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;in&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;infix&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;infixl&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;infixr&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;instance&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;let&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;module&quot;</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">,</span><span class="hs-string">&quot;newtype&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;of&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;qualified&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;then&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;where&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;_&quot;</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">,</span><span class="hs-string">&quot;foreign&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;ccall&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;as&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;safe&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;unsafe&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;family&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-130"></a><a name="keyglyphs"><a href="Language.Haskell.HsColour.Classify.html#keyglyphs"><span class="hs-identifier">keyglyphs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-special">[</span><span class="hs-string">&quot;..&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;::&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;\\&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;|&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;&lt;-&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;-&gt;&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;@&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;~&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;=&gt;&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;[&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-132"></a><a name="layoutchars"><a href="Language.Haskell.HsColour.Classify.html#layoutchars"><span class="hs-identifier">layoutchars</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;;{}(),&quot;</span><span>
</span><a name="line-134"></a><a name="symbols"><a href="Language.Haskell.HsColour.Classify.html#symbols"><span class="hs-identifier">symbols</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-string">&quot;!#$%&amp;*+./&lt;=&gt;?@\\^|-~&quot;</span><span>
</span><a name="line-136"></a></pre></body></html>