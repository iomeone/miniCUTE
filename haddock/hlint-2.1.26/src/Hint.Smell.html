<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.Smell</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span>  </span><a href="Hint.Smell.html#smellModuleHint"><span class="hs-identifier hs-var">smellModuleHint</span></a><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>  </span><a href="Hint.Smell.html#smellHint"><span class="hs-identifier hs-var">smellHint</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">{-
&lt;TEST&gt; [{smell: { type: many arg functions, limit: 2 }}]
f :: Int -&gt; Int \
f = undefined

f :: Int -&gt; Int -&gt; Int \
f = undefined --
&lt;/TEST&gt;

&lt;TEST&gt;
f :: Int -&gt; Int \
f = undefined

f :: Int -&gt; Int -&gt; Int \
f = undefined
&lt;/TEST&gt;

&lt;TEST&gt; [{smell: { type: long functions, limit: 3}}]
f = do \
 x &lt;- y \
 return x --

f = do \
  return z \
\
  where \
   z = do \
    a \
    b --

f = do \
  return z \
\
  where \
   z = a

f = Con \
  { a = x \
  , b = y \
  , c = z \
  }

f = return x
&lt;/TEST&gt;

&lt;TEST&gt;
f = do \
 x &lt;- y \
 return x

f = return x
&lt;/TEST&gt;

&lt;TEST&gt; [{smell: { type: long type lists, limit: 2}}]
f :: Bool -&gt; Int -&gt; (Int -&gt; Proxy '[a, b]) --
f :: Proxy '[a]
&lt;/TEST&gt;

&lt;TEST&gt;
f :: Proxy '[a, b]
f :: Proxy '[a]
&lt;/TEST&gt;

&lt;TEST&gt; [{smell: { type: many imports, limit: 2}}]
import A; import B --
import A
&lt;/TEST&gt;

&lt;TEST&gt;
import A; import B
import A
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><a href="Config.Type.html"><span class="hs-identifier">Config.Type</span></a><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-identifier">smellModuleHint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Config.Type.html#Setting"><span class="hs-identifier hs-type">Setting</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Type.html#ModuHint"><span class="hs-identifier hs-type">ModuHint</span></a><span>
</span><a name="line-88"></a><a name="smellModuleHint"><a href="Hint.Smell.html#smellModuleHint"><span class="hs-identifier">smellModuleHint</span></a></a><span> </span><a name="local-6989586621679285767"><a href="#local-6989586621679285767"><span class="hs-identifier">settings</span></a></a><span> </span><a name="local-6989586621679285768"><a href="#local-6989586621679285768"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621679285769"><a href="#local-6989586621679285769"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HSE.Util.html#moduleImports"><span class="hs-identifier hs-var">moduleImports</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679285770"><a href="#local-6989586621679285770"><span class="hs-identifier">imports</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="Config.Type.html#SmellManyImports"><span class="hs-identifier hs-var">SmellManyImports</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Smell.html#smells"><span class="hs-identifier hs-var">smells</span></a><span> </span><a href="#local-6989586621679285767"><span class="hs-identifier hs-var">settings</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679285771"><a href="#local-6989586621679285771"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679285770"><span class="hs-identifier hs-var">imports</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679285771"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-90"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679285773"><a href="#local-6989586621679285773"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl1</span><span> </span><span class="hs-identifier hs-var">mergeSrcSpan</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">srcInfoSpan</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ann</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679285770"><span class="hs-identifier hs-var">imports</span></a><span>
</span><a name="line-91"></a><span>               </span><a name="local-6989586621679285774"><a href="#local-6989586621679285774"><span class="hs-identifier">displayImports</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679285772"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679285770"><span class="hs-identifier hs-var">imports</span></a><span>
</span><a name="line-92"></a><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><a href="Idea.html#rawIdea"><span class="hs-identifier hs-var">rawIdea</span></a><span> </span><a href="Config.Type.html#Warning"><span class="hs-identifier hs-var">Warning</span></a><span> </span><span class="hs-string">&quot;Many imports&quot;</span><span> </span><a href="#local-6989586621679285773"><span class="hs-identifier hs-var">span</span></a><span> </span><a href="#local-6989586621679285774"><span class="hs-identifier hs-var">displayImports</span></a><span>  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>      </span><a name="local-6989586621679285772"><a href="#local-6989586621679285772"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">trimStart</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-identifier">smellHint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Config.Type.html#Setting"><span class="hs-identifier hs-type">Setting</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Type.html#DeclHint"><span class="hs-identifier hs-type">DeclHint</span></a><span>
</span><a name="line-98"></a><a name="smellHint"><a href="Hint.Smell.html#smellHint"><span class="hs-identifier">smellHint</span></a></a><span> </span><a name="local-6989586621679285775"><a href="#local-6989586621679285775"><span class="hs-identifier">settings</span></a></a><span> </span><a name="local-6989586621679285776"><a href="#local-6989586621679285776"><span class="hs-identifier">scope</span></a></a><span> </span><a name="local-6989586621679285777"><a href="#local-6989586621679285777"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679285778"><a href="#local-6989586621679285778"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-99"></a><span>  </span><a href="#local-6989586621679285779"><span class="hs-identifier hs-var">sniff</span></a><span> </span><a href="Hint.Smell.html#smellLongFunctions"><span class="hs-identifier hs-var">smellLongFunctions</span></a><span> </span><a href="Config.Type.html#SmellLongFunctions"><span class="hs-identifier hs-var">SmellLongFunctions</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-100"></a><span>  </span><a href="#local-6989586621679285779"><span class="hs-identifier hs-var">sniff</span></a><span> </span><a href="Hint.Smell.html#smellLongTypeLists"><span class="hs-identifier hs-var">smellLongTypeLists</span></a><span> </span><a href="Config.Type.html#SmellLongTypeLists"><span class="hs-identifier hs-var">SmellLongTypeLists</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-101"></a><span>  </span><a href="#local-6989586621679285779"><span class="hs-identifier hs-var">sniff</span></a><span> </span><a href="Hint.Smell.html#smellManyArgFunctions"><span class="hs-identifier hs-var">smellManyArgFunctions</span></a><span> </span><a href="Config.Type.html#SmellManyArgFunctions"><span class="hs-identifier hs-var">SmellManyArgFunctions</span></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-103"></a><span>    </span><a name="local-6989586621679285779"><a href="#local-6989586621679285779"><span class="hs-identifier">sniff</span></a></a><span> </span><a name="local-6989586621679285780"><a href="#local-6989586621679285780"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679285781"><a href="#local-6989586621679285781"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679285782"><a href="#local-6989586621679285782"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679285782"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">ideaTo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679285780"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679285778"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679285781"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Smell.html#smells"><span class="hs-identifier hs-var">smells</span></a><span> </span><a href="#local-6989586621679285775"><span class="hs-identifier hs-var">settings</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-identifier">smellLongFunctions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-106"></a><a name="smellLongFunctions"><a href="Hint.Smell.html#smellLongFunctions"><span class="hs-identifier">smellLongFunctions</span></a></a><span> </span><a name="local-6989586621679285783"><a href="#local-6989586621679285783"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679285784"><a href="#local-6989586621679285784"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679285786"><span class="hs-identifier hs-var">idea</span></a><span>
</span><a name="line-107"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679285785"><a href="#local-6989586621679285785"><span class="hs-identifier">span</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679285786"><a href="#local-6989586621679285786"><span class="hs-identifier">idea</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hint.Smell.html#declSpans"><span class="hs-identifier hs-var">declSpans</span></a><span> </span><a href="#local-6989586621679285783"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-108"></a><span>                         </span><span class="hs-special">,</span><span> </span><a href="Hint.Smell.html#spanLength"><span class="hs-identifier hs-var">spanLength</span></a><span> </span><a href="#local-6989586621679285785"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679285784"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-109"></a><span>                         </span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">declSpans</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanInfo</span><span class="hs-special">,</span><span> </span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-112"></a><a name="declSpans"><a href="Hint.Smell.html#declSpans"><span class="hs-identifier">declSpans</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285787"><a href="#local-6989586621679285787"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679285788"><a href="#local-6989586621679285788"><span class="hs-identifier">where_</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Smell.html#rhsSpans"><span class="hs-identifier hs-var">rhsSpans</span></a><span> </span><a href="#local-6989586621679285787"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Hint.Smell.html#whereSpans"><span class="hs-identifier hs-var">whereSpans</span></a><span> </span><a href="#local-6989586621679285788"><span class="hs-identifier hs-var">where_</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">declSpans</span><span> </span><a name="local-6989586621679285789"><a href="#local-6989586621679285789"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span>  </span><a name="local-6989586621679285790"><a href="#local-6989586621679285790"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679285791"><a href="#local-6989586621679285791"><span class="hs-identifier">match</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679285790"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Long function&quot;</span><span> </span><a href="#local-6989586621679285789"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679285789"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- count where clauses</span><span>
</span><a name="line-114"></a><span class="hs-identifier">declSpans</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285792"><a href="#local-6989586621679285792"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679285793"><a href="#local-6989586621679285793"><span class="hs-identifier">where_</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Smell.html#rhsSpans"><span class="hs-identifier hs-var">rhsSpans</span></a><span> </span><a href="#local-6989586621679285792"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Hint.Smell.html#whereSpans"><span class="hs-identifier hs-var">whereSpans</span></a><span> </span><a href="#local-6989586621679285793"><span class="hs-identifier hs-var">where_</span></a><span>
</span><a name="line-115"></a><span class="hs-identifier">declSpans</span><span> </span><span class="hs-identifier">_</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-identifier">whereSpans</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Binds</span><span> </span><span class="hs-identifier hs-type">SrcSpanInfo</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanInfo</span><span class="hs-special">,</span><span> </span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-118"></a><a name="whereSpans"><a href="Hint.Smell.html#whereSpans"><span class="hs-identifier">whereSpans</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BDecls</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285794"><a href="#local-6989586621679285794"><span class="hs-identifier">decls</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.Smell.html#declSpans"><span class="hs-identifier hs-var">declSpans</span></a><span> </span><a href="#local-6989586621679285794"><span class="hs-identifier hs-var">decls</span></a><span>
</span><a name="line-119"></a><span class="hs-identifier">whereSpans</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">rhsSpans</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rhs</span><span> </span><span class="hs-identifier hs-type">SrcSpanInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpanInfo</span><span class="hs-special">,</span><span> </span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-122"></a><a name="rhsSpans"><a href="Hint.Smell.html#rhsSpans"><span class="hs-identifier">rhsSpans</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a name="local-6989586621679285795"><a href="#local-6989586621679285795"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier hs-var">RecConstr</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--- record constructors get a pass</span><span>
</span><a name="line-123"></a><span class="hs-identifier">rhsSpans</span><span> </span><a name="local-6989586621679285796"><a href="#local-6989586621679285796"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a name="local-6989586621679285797"><a href="#local-6989586621679285797"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679285797"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Long function&quot;</span><span> </span><a href="#local-6989586621679285796"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679285796"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-124"></a><span class="hs-identifier">rhsSpans</span><span> </span><a name="local-6989586621679285798"><a href="#local-6989586621679285798"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><a name="local-6989586621679285799"><a href="#local-6989586621679285799"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679285799"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Long function&quot;</span><span> </span><a href="#local-6989586621679285798"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679285798"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-identifier">spanLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SrcSpanInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-127"></a><a name="spanLength"><a href="Hint.Smell.html#spanLength"><span class="hs-identifier">spanLength</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SrcSpanInfo</span><span> </span><a name="local-6989586621679285800"><a href="#local-6989586621679285800"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">srcSpanEndLine</span><span> </span><a href="#local-6989586621679285800"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">srcSpanStartLine</span><span> </span><a href="#local-6989586621679285800"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-identifier">smellLongTypeLists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-130"></a><a name="smellLongTypeLists"><a href="Hint.Smell.html#smellLongTypeLists"><span class="hs-identifier">smellLongTypeLists</span></a></a><span> </span><a name="local-6989586621679285801"><a href="#local-6989586621679285801"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285802"><a href="#local-6989586621679285802"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679285803"><a href="#local-6989586621679285803"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Long type list&quot;</span><span> </span><a href="#local-6989586621679285801"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679285801"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679285804"><span class="hs-identifier hs-var">longTypeList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679285802"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-132"></a><span>    </span><a name="local-6989586621679285804"><a href="#local-6989586621679285804"><span class="hs-identifier">longTypeList</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyPromoted</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PromotedList</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285805"><a href="#local-6989586621679285805"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679285805"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679285803"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-identifier">longTypeList</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-134"></a><span class="hs-identifier">smellLongTypeLists</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-identifier">smellManyArgFunctions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-137"></a><a name="smellManyArgFunctions"><a href="Hint.Smell.html#smellManyArgFunctions"><span class="hs-identifier">smellManyArgFunctions</span></a></a><span> </span><a name="local-6989586621679285806"><a href="#local-6989586621679285806"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285807"><a href="#local-6989586621679285807"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679285808"><a href="#local-6989586621679285808"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Many arg function&quot;</span><span> </span><a href="#local-6989586621679285806"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679285806"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;$</span><span>  </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679285809"><span class="hs-identifier hs-var">manyArgFunction</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679285807"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-6989586621679285809"><a href="#local-6989586621679285809"><span class="hs-identifier">manyArgFunction</span></a></a><span> </span><a name="local-6989586621679285810"><a href="#local-6989586621679285810"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Smell.html#countFunctionArgs"><span class="hs-identifier hs-var">countFunctionArgs</span></a><span> </span><a href="#local-6989586621679285810"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679285808"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-140"></a><span class="hs-identifier">smellManyArgFunctions</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-identifier">countFunctionArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Type</span><span> </span><a href="#local-6989586621679285766"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-143"></a><a name="countFunctionArgs"><a href="Hint.Smell.html#countFunctionArgs"><span class="hs-identifier">countFunctionArgs</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyFun</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285811"><a href="#local-6989586621679285811"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Hint.Smell.html#countFunctionArgs"><span class="hs-identifier hs-var">countFunctionArgs</span></a><span> </span><a href="#local-6989586621679285811"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-144"></a><span class="hs-identifier">countFunctionArgs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyParen</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679285812"><a href="#local-6989586621679285812"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Smell.html#countFunctionArgs"><span class="hs-identifier hs-var">countFunctionArgs</span></a><span> </span><a href="#local-6989586621679285812"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-145"></a><span class="hs-identifier">countFunctionArgs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-identifier">smells</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Config.Type.html#Setting"><span class="hs-identifier hs-type">Setting</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map.Map</span><span> </span><a href="Config.Type.html#SmellType"><span class="hs-identifier hs-type">SmellType</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-148"></a><a name="smells"><a href="Hint.Smell.html#smells"><span class="hs-identifier">smells</span></a></a><span> </span><a name="local-6989586621679285813"><a href="#local-6989586621679285813"><span class="hs-identifier">settings</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679285814"><span class="hs-identifier hs-var">smellType</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679285815"><span class="hs-identifier hs-var">smellLimit</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Config.Type.html#SettingSmell"><span class="hs-identifier hs-var">SettingSmell</span></a><span> </span><a name="local-6989586621679285814"><a href="#local-6989586621679285814"><span class="hs-identifier">smellType</span></a></a><span> </span><a name="local-6989586621679285815"><a href="#local-6989586621679285815"><span class="hs-identifier">smellLimit</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679285813"><span class="hs-identifier hs-var">settings</span></a><span class="hs-special">]</span><span>
</span><a name="line-149"></a></pre></body></html>