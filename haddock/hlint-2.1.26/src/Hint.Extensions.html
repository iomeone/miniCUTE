<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-
    Suggest removal of unnecessary extensions
    i.e. They have {-# LANGUAGE RecursiveDo #-} but no mdo keywords
&lt;TEST&gt;
{-# LANGUAGE Arrows #-} \
f = id --
{-# LANGUAGE RebindableSyntax #-} \
f = id
{-# LANGUAGE RebindableSyntax, ParallelListComp, ImplicitParams #-} \
f = [(a,c) | a &lt;- b | c &lt;- d] -- {-# LANGUAGE RebindableSyntax, ParallelListComp #-}
{-# LANGUAGE EmptyDataDecls #-} \
data Foo
{-# LANGUAGE TemplateHaskell #-} \
$(deriveNewtypes typeInfo)
{-# LANGUAGE TemplateHaskell #-} \
main = foo ''Bar
{-# LANGUAGE PatternGuards #-} \
test = case x of _ | y &lt;- z -&gt; w
{-# LANGUAGE TemplateHaskell,EmptyDataDecls #-} \
$(fmap return $ dataD (return []) (mkName &quot;Void&quot;) [] [] [])
{-# LANGUAGE RecursiveDo #-} \
main = mdo x &lt;- y; return y
{-# LANGUAGE RecursiveDo #-} \
main = do {rec {x &lt;- return 1}; print x}
{-# LANGUAGE ImplicitParams, BangPatterns #-} \
sort :: (?cmp :: a -&gt; a -&gt; Bool) =&gt; [a] -&gt; [a] \
sort !f = undefined
{-# LANGUAGE KindSignatures #-} \
data Set (cxt :: * -&gt; *) a = Set [a]
{-# LANGUAGE RecordWildCards #-} \
record field = Record{..}
{-# LANGUAGE RecordWildCards #-} \
record = 1 -- @Note may require `{-# LANGUAGE DisambiguateRecordFields #-}` adding to the top of the file
{-# LANGUAGE RecordWildCards #-} \
{-# LANGUAGE DisambiguateRecordFields #-} \
record = 1 -- @NoNote
{-# LANGUAGE UnboxedTuples #-} \
record = 1 --
{-# LANGUAGE TemplateHaskell #-} \
foo
{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveDataTypeable #-} \
record = 1 --
{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveDataTypeable #-} \
newtype Foo = Foo Int deriving Data -- {-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveDataTypeable #-} \
data Foo = Foo Int deriving Data -- {-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveDataTypeable #-} \
newtype Foo = Foo Int deriving Class -- {-# LANGUAGE GeneralizedNewtypeDeriving #-}
{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveDataTypeable #-} \
data Foo = Foo Int deriving Class --
{-# LANGUAGE DeriveFunctor #-} \
data Foo = Foo Int deriving Functor
{-# LANGUAGE DeriveFunctor #-} \
newtype Foo = Foo Int deriving Functor
{-# LANGUAGE GeneralizedNewtypeDeriving #-} \
newtype Foo = Foo Int deriving Functor
{-# LANGUAGE GeneralizedNewtypeDeriving #-} \
newtype Foo = Foo Int deriving Data --
{-# LANGUAGE DeriveFunctor, GeneralizedNewtypeDeriving, StandaloneDeriving #-} \
deriving instance Functor Bar
{-# LANGUAGE DeriveFunctor, GeneralizedNewtypeDeriving, StandaloneDeriving #-} \
deriving instance Show Bar -- {-# LANGUAGE StandaloneDeriving #-}
{-# LANGUAGE DeriveGeneric, GeneralizedNewtypeDeriving #-} \
newtype Micro = Micro Int deriving Generic -- {-# LANGUAGE DeriveGeneric #-}
{-# LANGUAGE GeneralizedNewtypeDeriving #-} \
instance Class Int where {newtype MyIO a = MyIO a deriving NewClass}
{-# LANGUAGE UnboxedTuples #-} \
f :: Int -&gt; (# Int, Int #)
{-# LANGUAGE UnboxedTuples #-} \
f :: x -&gt; (x, x); f x = (x, x) --
{-# LANGUAGE DefaultSignatures #-} \
class Val a where; val :: a --
{-# LANGUAGE DefaultSignatures #-} \
class Val a where; val :: a; default val :: Int
{-# LANGUAGE TypeApplications #-} \
foo = id --
{-# LANGUAGE TypeApplications #-} \
foo = id @Int
{-# LANGUAGE LambdaCase #-} \
foo = id --
{-# LANGUAGE LambdaCase #-} \
foo = \case () -&gt; ()
{-# LANGUAGE NumDecimals #-} \
foo = 12.3e2
{-# LANGUAGE NumDecimals #-} \
foo = id --
{-# LANGUAGE NumDecimals #-} \
foo = 12.345e2 --
{-# LANGUAGE TupleSections #-} \
main = map (,1,2) xs
{-# LANGUAGE TupleSections #-} \
main = id --
{-# LANGUAGE OverloadedStrings #-} \
main = &quot;test&quot;
{-# LANGUAGE OverloadedStrings #-} \
main = id --
{-# LANGUAGE DeriveAnyClass #-} \
main = id --
{-# LANGUAGE DeriveAnyClass #-} \
data Foo = Foo deriving Bob
{-# LANGUAGE DeriveAnyClass #-} \
data Foo a = Foo a deriving (Eq,Data,Functor) --
{-# LANGUAGE MagicHash #-} \
foo# = id
{-# LANGUAGE MagicHash #-} \
main = &quot;foo&quot;#
{-# LANGUAGE MagicHash #-} \
main = 5#
{-# LANGUAGE MagicHash #-} \
main = 'a'#
{-# LANGUAGE MagicHash #-} \
main = 5.6#
{-# LANGUAGE MagicHash #-} \
foo = id --
{-# LANGUAGE GeneralizedNewtypeDeriving #-} \
newtype X = X Int deriving newtype Show
{-# LANGUAGE EmptyCase #-} \
main = case () of {}
{-# LANGUAGE EmptyCase #-} \
main = case () of x -&gt; x --
{-# LANGUAGE EmptyCase #-} \
main = case () of x -&gt; x --
{-# LANGUAGE PolyKinds, KindSignatures #-} -- {-# LANGUAGE PolyKinds #-}
{-# LANGUAGE PolyKinds, KindSignatures #-} \
data Set (cxt :: * -&gt; *) a = Set [a] -- @Note Extension KindSignatures is implied by PolyKinds
{-# LANGUAGE QuasiQuotes, OverloadedStrings #-} \
main = putStrLn [f|{T.intercalate &quot;blah&quot; []}|]
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.Extensions</span><span class="hs-special">(</span><a href="Hint.Extensions.html#extensionsHint"><span class="hs-identifier hs-var">extensionsHint</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-137"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Extra</span><span>
</span><a name="line-138"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-139"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-140"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ratio</span><span>
</span><a name="line-141"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>
</span><a name="line-142"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Refact.Types</span><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-145"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">extensionsHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hint.Type.html#ModuHint"><span class="hs-identifier hs-type">ModuHint</span></a><span>
</span><a name="line-150"></a><a name="extensionsHint"><a href="Hint.Extensions.html#extensionsHint"><span class="hs-identifier">extensionsHint</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280568"><a href="#local-6989586621679280568"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Idea.html#rawIdea"><span class="hs-identifier hs-var">rawIdea</span></a><span> </span><a href="Config.Type.html#Warning"><span class="hs-identifier hs-var">Warning</span></a><span> </span><span class="hs-string">&quot;Unused LANGUAGE pragma&quot;</span><span>
</span><a name="line-152"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">srcInfoSpan</span><span> </span><a href="#local-6989586621679280585"><span class="hs-identifier hs-var">sl</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679280584"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679280590"><span class="hs-identifier hs-var">newPragma</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><a href="Config.Type.html#RequiresExtension"><span class="hs-identifier hs-var">RequiresExtension</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">prettyExtension</span><span> </span><a href="#local-6989586621679280592"><span class="hs-identifier hs-var">gone</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679280591"><a href="#local-6989586621679280591"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679280587"><span class="hs-identifier hs-var">before</span></a><span> </span><span class="hs-operator hs-var">\\</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679280592"><a href="#local-6989586621679280592"><span class="hs-identifier">gone</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map.findWithDefault</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679280591"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679280574"><span class="hs-identifier hs-var">disappear</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-156"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="Config.Type.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Extension &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">prettyExtension</span><span> </span><a href="#local-6989586621679280593"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; is &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679280575"><span class="hs-identifier hs-var">reason</span></a><span> </span><a href="#local-6989586621679280593"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-157"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679280593"><a href="#local-6989586621679280593"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679280589"><span class="hs-identifier hs-var">explainedRemovals</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-var">ModifyComment</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679280584"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280590"><span class="hs-identifier hs-var">newPragma</span></a><span class="hs-special">]</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679280584"><a href="#local-6989586621679280584"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">LanguagePragma</span><span> </span><a name="local-6989586621679280585"><a href="#local-6989586621679280585"><span class="hs-identifier">sl</span></a></a><span> </span><a name="local-6989586621679280586"><a href="#local-6989586621679280586"><span class="hs-identifier">exts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HSE.Util.html#modulePragmas"><span class="hs-identifier hs-var">modulePragmas</span></a><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679280587"><a href="#local-6989586621679280587"><span class="hs-identifier">before</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parseExtension</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280586"><span class="hs-identifier hs-var">exts</span></a><span>
</span><a name="line-161"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679280588"><a href="#local-6989586621679280588"><span class="hs-identifier">after</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280573"><span class="hs-identifier hs-var">keep</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280587"><span class="hs-identifier hs-var">before</span></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679280587"><span class="hs-identifier hs-var">before</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679280589"><a href="#local-6989586621679280589"><span class="hs-identifier">explainedRemovals</span></a></a><span>
</span><a name="line-164"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">Map.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280572"><span class="hs-identifier hs-var">implied</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280587"><span class="hs-identifier hs-var">before</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-165"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280587"><span class="hs-identifier hs-var">before</span></a><span> </span><span class="hs-operator hs-var">\\</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679280590"><a href="#local-6989586621679280590"><span class="hs-identifier">newPragma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LanguagePragma</span><span> </span><a href="#local-6989586621679280585"><span class="hs-identifier hs-var">sl</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">prettyExtension</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280588"><span class="hs-identifier hs-var">after</span></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-169"></a><span>        </span><a name="local-6989586621679280569"><a href="#local-6989586621679280569"><span class="hs-identifier">usedTH</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#used"><span class="hs-identifier hs-var">used</span></a><span> </span><span class="hs-identifier hs-var">TemplateHaskell</span><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Hint.Extensions.html#used"><span class="hs-identifier hs-var">used</span></a><span> </span><span class="hs-identifier hs-var">QuasiQuotes</span><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-170"></a><span>            </span><span class="hs-comment">-- if TH or QuasiQuotes is on, can use all other extensions programmatically</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>        </span><span class="hs-comment">-- all the extensions defined to be used</span><span>
</span><a name="line-173"></a><span>        </span><a name="local-6989586621679280570"><a href="#local-6989586621679280570"><span class="hs-identifier">extensions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">parseExtension</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679280577"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">LanguagePragma</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280576"><a href="#local-6989586621679280576"><span class="hs-identifier">exts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HSE.Util.html#modulePragmas"><span class="hs-identifier hs-var">modulePragmas</span></a><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679280577"><a href="#local-6989586621679280577"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679280576"><span class="hs-identifier hs-var">exts</span></a><span class="hs-special">]</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>        </span><span class="hs-comment">-- those extensions we detect to be useful</span><span>
</span><a name="line-176"></a><span>        </span><a name="local-6989586621679280571"><a href="#local-6989586621679280571"><span class="hs-identifier">useful</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679280569"><span class="hs-identifier hs-var">usedTH</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679280570"><span class="hs-identifier hs-var">extensions</span></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Set.filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="Hint.Extensions.html#usedExt"><span class="hs-identifier hs-var">usedExt</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280570"><span class="hs-identifier hs-var">extensions</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>        </span><span class="hs-comment">-- those extensions which are useful, but implied by other useful extensions</span><span>
</span><a name="line-179"></a><span>        </span><a name="local-6989586621679280572"><a href="#local-6989586621679280572"><span class="hs-identifier">implied</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span>
</span><a name="line-180"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280578"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679280579"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679280578"><a href="#local-6989586621679280578"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Set.toList</span><span> </span><a href="#local-6989586621679280571"><span class="hs-identifier hs-var">useful</span></a><span>
</span><a name="line-182"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="local-6989586621679280579"><a href="#local-6989586621679280579"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280571"><span class="hs-identifier hs-var">useful</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#extensionImpliedBy"><span class="hs-identifier hs-var">extensionImpliedBy</span></a><span> </span><a href="#local-6989586621679280578"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>        </span><span class="hs-comment">-- those we should keep</span><span>
</span><a name="line-185"></a><span>        </span><a name="local-6989586621679280573"><a href="#local-6989586621679280573"><span class="hs-identifier">keep</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679280571"><span class="hs-identifier hs-var">useful</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.difference</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">Map.keysSet</span><span> </span><a href="#local-6989586621679280572"><span class="hs-identifier hs-var">implied</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span>        </span><span class="hs-comment">-- (a,b) means a used to imply b, but has gone, so suggest enabling b</span><span>
</span><a name="line-188"></a><span>        </span><a name="local-6989586621679280574"><a href="#local-6989586621679280574"><span class="hs-identifier">disappear</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-189"></a><span>            </span><span class="hs-identifier hs-var">Map.fromListWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-190"></a><span>            </span><span class="hs-identifier hs-var">nubOrdOn</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-comment">-- only keep one instance for each of a</span><span>
</span><a name="line-191"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280580"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679280581"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679280580"><a href="#local-6989586621679280580"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Set.toList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679280570"><span class="hs-identifier hs-var">extensions</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.difference</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280573"><span class="hs-identifier hs-var">keep</span></a><span>
</span><a name="line-193"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="local-6989586621679280581"><a href="#local-6989586621679280581"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HSE.Util.html#extensionImplies"><span class="hs-identifier hs-var">extensionImplies</span></a><span> </span><a href="#local-6989586621679280580"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-194"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679280581"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.notMember</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280571"><span class="hs-identifier hs-var">useful</span></a><span>
</span><a name="line-195"></a><span>            </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679280569"><span class="hs-identifier hs-var">usedTH</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Hint.Extensions.html#usedExt"><span class="hs-identifier hs-var">usedExt</span></a><span> </span><a href="#local-6989586621679280581"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679280568"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-196"></a><span>            </span><span class="hs-special">]</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>        </span><a name="local-6989586621679280575"><a href="#local-6989586621679280575"><span class="hs-identifier">reason</span></a></a><span> </span><a name="local-6989586621679280582"><a href="#local-6989586621679280582"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-199"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679280582"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679280572"><span class="hs-identifier hs-var">implied</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-200"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679280583"><a href="#local-6989586621679280583"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;implied by &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">prettyExtension</span><span> </span><a href="#local-6989586621679280583"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-201"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;not used&quot;</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><a name="deriveHaskell"><a href="Hint.Extensions.html#deriveHaskell"><span class="hs-identifier">deriveHaskell</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Eq&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Ord&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Enum&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Ix&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Bounded&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Read&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Show&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-204"></a><a name="deriveGenerics"><a href="Hint.Extensions.html#deriveGenerics"><span class="hs-identifier">deriveGenerics</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Data&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Typeable&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Generic&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Generic1&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Lift&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><a name="deriveCategory"><a href="Hint.Extensions.html#deriveCategory"><span class="hs-identifier">deriveCategory</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Functor&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Foldable&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Traversable&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | Classes that can't require newtype deriving</span><span>
</span><a name="line-208"></a><a name="noDeriveNewtype"><a href="Hint.Extensions.html#noDeriveNewtype"><span class="hs-identifier">noDeriveNewtype</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-identifier hs-var">delete</span><span> </span><span class="hs-string">&quot;Enum&quot;</span><span> </span><a href="Hint.Extensions.html#deriveHaskell"><span class="hs-identifier hs-var">deriveHaskell</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- Enum can't always be derived on a newtype</span><span>
</span><a name="line-210"></a><span>    </span><a href="Hint.Extensions.html#deriveGenerics"><span class="hs-identifier hs-var">deriveGenerics</span></a><span> </span><span class="hs-comment">-- Generics stuff can't newtype derive since it has the ctor in it</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Classes that can appear as stock, and can't appear as anyclass</span><span>
</span><a name="line-213"></a><a name="deriveStock"><a href="Hint.Extensions.html#deriveStock"><span class="hs-identifier">deriveStock</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#deriveHaskell"><span class="hs-identifier hs-var">deriveHaskell</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Hint.Extensions.html#deriveGenerics"><span class="hs-identifier hs-var">deriveGenerics</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Hint.Extensions.html#deriveCategory"><span class="hs-identifier hs-var">deriveCategory</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-identifier">usedExt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Extension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Module_"><span class="hs-identifier hs-type">Module_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-217"></a><a name="usedExt"><a href="Hint.Extensions.html#usedExt"><span class="hs-identifier">usedExt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EnableExtension</span><span> </span><a name="local-6989586621679280594"><a href="#local-6989586621679280594"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#used"><span class="hs-identifier hs-var">used</span></a><span> </span><a href="#local-6989586621679280594"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-218"></a><span class="hs-identifier">usedExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnknownExtension</span><span> </span><span class="hs-string">&quot;NumDecimals&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="Hint.Extensions.html#isWholeFrac"><span class="hs-identifier hs-var">isWholeFrac</span></a><span>
</span><a name="line-219"></a><span class="hs-identifier">usedExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnknownExtension</span><span> </span><span class="hs-string">&quot;DeriveLift&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Lift&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-220"></a><span class="hs-identifier">usedExt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnknownExtension</span><span> </span><span class="hs-string">&quot;DeriveAnyClass&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">derivesAnyclass</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Hint.Extensions.html#derives"><span class="hs-identifier hs-var">derives</span></a><span>
</span><a name="line-221"></a><span class="hs-identifier">usedExt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-identifier">used</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">KnownExtension</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Module_"><span class="hs-identifier hs-type">Module_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-225"></a><a name="used"><a href="Hint.Extensions.html#used"><span class="hs-identifier">used</span></a></a><span> </span><span class="hs-identifier hs-var">RecursiveDo</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isMDo"><span class="hs-identifier hs-var">isMDo</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isRecStmt"><span class="hs-identifier hs-var">isRecStmt</span></a><span>
</span><a name="line-226"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">ParallelListComp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isParComp"><span class="hs-identifier hs-var">isParComp</span></a><span>
</span><a name="line-227"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">FunctionalDependencies</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Extensions.html#un"><span class="hs-identifier hs-var">un</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FunDep</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">ImplicitParams</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Extensions.html#un"><span class="hs-identifier hs-var">un</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IPName</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">TypeApplications</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isTypeApp"><span class="hs-identifier hs-var">isTypeApp</span></a><span>
</span><a name="line-230"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">EmptyDataDecls</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280595"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-231"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280595"><a href="#local-6989586621679280595"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-232"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GDataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-233"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-234"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">EmptyCase</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280596"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280596"><a href="#local-6989586621679280596"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Case</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-236"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LCase</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-237"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-238"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">KindSignatures</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Extensions.html#un"><span class="hs-identifier hs-var">un</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Kind</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">BangPatterns</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPBangPat"><span class="hs-identifier hs-var">isPBangPat</span></a><span>
</span><a name="line-240"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">TemplateHaskell</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT2"><span class="hs-identifier hs-var">hasT2</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Extensions.html#un"><span class="hs-identifier hs-var">un</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bracket</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Splice</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280597"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isSpliceDecl"><span class="hs-identifier hs-var">isSpliceDecl</span></a><span>
</span><a name="line-241"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280597"><a href="#local-6989586621679280597"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier hs-var">VarQuote</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-242"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">TypQuote</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-243"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-244"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">ForeignFunctionInterface</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><span class="hs-special">(</span><a href="Hint.Extensions.html#un"><span class="hs-identifier hs-var">un</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CallConv</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">PatternGuards</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280598"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-246"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280598"><a href="#local-6989586621679280598"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280600"><a href="#local-6989586621679280600"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280599"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280600"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-247"></a><span>          </span><a name="local-6989586621679280599"><a href="#local-6989586621679280599"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-248"></a><span>          </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Qualifier</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-249"></a><span>          </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-250"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">StandaloneDeriving</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isDerivDecl"><span class="hs-identifier hs-var">isDerivDecl</span></a><span>
</span><a name="line-251"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">PatternSignatures</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPatTypeSig"><span class="hs-identifier hs-var">isPatTypeSig</span></a><span>
</span><a name="line-252"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">RecordWildCards</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPFieldWildcard"><span class="hs-identifier hs-var">isPFieldWildcard</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isFieldWildcard"><span class="hs-identifier hs-var">isFieldWildcard</span></a><span>
</span><a name="line-253"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">RecordPuns</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPFieldPun"><span class="hs-identifier hs-var">isPFieldPun</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isFieldPun"><span class="hs-identifier hs-var">isFieldPun</span></a><span>
</span><a name="line-254"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">NamedFieldPuns</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPFieldPun"><span class="hs-identifier hs-var">isPFieldPun</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isFieldPun"><span class="hs-identifier hs-var">isFieldPun</span></a><span>
</span><a name="line-255"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">UnboxedTuples</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#has"><span class="hs-identifier hs-var">has</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HSE.Util.html#isBoxed"><span class="hs-identifier hs-var">isBoxed</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">PackageImports</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">importPkg</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">QuasiQuotes</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isQuasiQuote"><span class="hs-identifier hs-var">isQuasiQuote</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isTyQuasiQuote"><span class="hs-identifier hs-var">isTyQuasiQuote</span></a><span>
</span><a name="line-258"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">ViewPatterns</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPViewPat"><span class="hs-identifier hs-var">isPViewPat</span></a><span>
</span><a name="line-259"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DefaultSignatures</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isClsDefSig"><span class="hs-identifier hs-var">isClsDefSig</span></a><span>
</span><a name="line-260"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DeriveDataTypeable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Data&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Typeable&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-261"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DeriveFunctor</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Functor&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-262"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DeriveFoldable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Foldable&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DeriveTraversable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Traversable&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Foldable&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Functor&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-264"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">DeriveGeneric</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier hs-var">hasDerive</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Generic&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;Generic1&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-265"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">GeneralizedNewtypeDeriving</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">derivesNewtype</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Hint.Extensions.html#derives"><span class="hs-identifier hs-var">derives</span></a><span>
</span><a name="line-266"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">LambdaCase</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isLCase"><span class="hs-identifier hs-var">isLCase</span></a><span>
</span><a name="line-267"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">TupleSections</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isTupleSection"><span class="hs-identifier hs-var">isTupleSection</span></a><span>
</span><a name="line-268"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">OverloadedStrings</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isString"><span class="hs-identifier hs-var">isString</span></a><span>
</span><a name="line-269"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">Arrows</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280601"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280601"><a href="#local-6989586621679280601"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier hs-var">Proc</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-271"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">LeftArrApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-272"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">RightArrApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-273"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">LeftArrHighApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-274"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">RightArrHighApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-275"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-276"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">TransformListComp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280602"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-277"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280602"><a href="#local-6989586621679280602"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier hs-var">QualStmt</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-278"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-279"></a><span class="hs-identifier">used</span><span> </span><span class="hs-identifier hs-var">MagicHash</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="#local-6989586621679280603"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasS"><span class="hs-identifier hs-var">hasS</span></a><span> </span><a href="HSE.Util.html#isPrimLiteral"><span class="hs-identifier hs-var">isPrimLiteral</span></a><span>
</span><a name="line-280"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679280603"><a href="#local-6989586621679280603"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280604"><a href="#local-6989586621679280604"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isSuffixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280604"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-281"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- for forwards compatibility, if things ever get added to the extension enumeration</span><span>
</span><a name="line-284"></a><span class="hs-identifier">used</span><span> </span><a name="local-6989586621679280605"><a href="#local-6989586621679280605"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#usedExt"><span class="hs-identifier hs-var">usedExt</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">UnknownExtension</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679280605"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-identifier">hasDerive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Module_"><span class="hs-identifier hs-type">Module_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-288"></a><a name="hasDerive"><a href="Hint.Extensions.html#hasDerive"><span class="hs-identifier">hasDerive</span></a></a><span> </span><a name="local-6989586621679280606"><a href="#local-6989586621679280606"><span class="hs-identifier">want</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679280606"><span class="hs-identifier hs-var">want</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">derivesStock</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Hint.Extensions.html#derives"><span class="hs-identifier hs-var">derives</span></a><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-comment">-- Derivations can be implemented using any one of 3 strategies, so for each derivation</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- add it to all the strategies that might plausibly implement it</span><span>
</span><a name="line-293"></a><span class="hs-keyword">data</span><span> </span><a name="Derives"><a href="Hint.Extensions.html#Derives"><span class="hs-identifier">Derives</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Derives"><a href="Hint.Extensions.html#Derives"><span class="hs-identifier">Derives</span></a></a><span>
</span><a name="line-294"></a><span>    </span><span class="hs-special">{</span><a name="derivesStock"><a href="Hint.Extensions.html#derivesStock"><span class="hs-identifier">derivesStock</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-295"></a><span>    </span><span class="hs-special">,</span><a name="derivesAnyclass"><a href="Hint.Extensions.html#derivesAnyclass"><span class="hs-identifier">derivesAnyclass</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-296"></a><span>    </span><span class="hs-special">,</span><a name="derivesNewtype"><a href="Hint.Extensions.html#derivesNewtype"><span class="hs-identifier">derivesNewtype</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-298"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-299"></a><span>    </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-var">Derives</span></a><span> </span><a name="local-6989586621679280560"><a href="#local-6989586621679280560"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679280561"><a href="#local-6989586621679280561"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679280562"><a href="#local-6989586621679280562"><span class="hs-identifier">x3</span></a></a><span> </span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-var">Derives</span></a><span> </span><a name="local-6989586621679280563"><a href="#local-6989586621679280563"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679280564"><a href="#local-6989586621679280564"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679280565"><a href="#local-6989586621679280565"><span class="hs-identifier">y3</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-300"></a><span>        </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-var">Derives</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280560"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679280563"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280561"><span class="hs-identifier hs-var">x2</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679280564"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280562"><span class="hs-identifier hs-var">x3</span></a><span class="hs-operator hs-var">++</span><a href="#local-6989586621679280565"><span class="hs-identifier hs-var">y3</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-302"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-var">Derives</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-303"></a><span>    </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">addDerives</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DataOrNew</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">DerivStrategy</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span>
</span><a name="line-306"></a><a name="addDerives"><a href="Hint.Extensions.html#addDerives"><span class="hs-identifier">addDerives</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679280607"><a href="#local-6989586621679280607"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679280608"><a href="#local-6989586621679280608"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679280607"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-307"></a><span>    </span><span class="hs-identifier hs-var">DerivStock</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">{</span><span class="hs-identifier">derivesStock</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280608"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">}</span><span>
</span><a name="line-308"></a><span>    </span><span class="hs-identifier hs-var">DerivAnyclass</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">{</span><span class="hs-identifier">derivesAnyclass</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280608"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">}</span><span>
</span><a name="line-309"></a><span>    </span><span class="hs-identifier hs-var">DerivNewtype</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">{</span><span class="hs-identifier">derivesNewtype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280608"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">}</span><span>
</span><a name="line-310"></a><span>    </span><span class="hs-identifier hs-var">DerivVia</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-311"></a><span class="hs-identifier">addDerives</span><span> </span><a name="local-6989586621679280609"><a href="#local-6989586621679280609"><span class="hs-identifier">nt</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280610"><a href="#local-6989586621679280610"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-312"></a><span>    </span><span class="hs-special">{</span><span class="hs-identifier">derivesStock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">stock</span><span>
</span><a name="line-313"></a><span>    </span><span class="hs-special">,</span><span class="hs-identifier">derivesAnyclass</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280612"><span class="hs-identifier hs-var">other</span></a><span>
</span><a name="line-314"></a><span>    </span><span class="hs-special">,</span><span class="hs-identifier">derivesNewtype</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="HSE.Util.html#isNewType"><span class="hs-identifier hs-var">isNewType</span></a><span> </span><a href="#local-6989586621679280609"><span class="hs-identifier hs-var">nt</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><a href="Hint.Extensions.html#noDeriveNewtype"><span class="hs-identifier hs-var">noDeriveNewtype</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280610"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">stock</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679280612"><a href="#local-6989586621679280612"><span class="hs-identifier">other</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">partition</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Hint.Extensions.html#deriveStock"><span class="hs-identifier hs-var">deriveStock</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280610"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">-- | What is derived on newtype, and on data type</span><span>
</span><a name="line-319"></a><span class="hs-comment">--   'deriving' declarations may be on either, so we approximate as both newtype and data</span><span>
</span><a name="line-320"></a><span class="hs-identifier">derives</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Module_"><span class="hs-identifier hs-type">Module_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span>
</span><a name="line-321"></a><a name="derives"><a href="Hint.Extensions.html#derives"><span class="hs-identifier">derives</span></a></a><span> </span><a name="local-6989586621679280613"><a href="#local-6989586621679280613"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679280615"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">childrenBi</span><span> </span><a href="#local-6989586621679280613"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679280614"><span class="hs-identifier hs-var">idecl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">childrenBi</span><span> </span><a href="#local-6989586621679280613"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-323"></a><span>        </span><span class="hs-identifier">idecl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">InstDecl</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span>
</span><a name="line-324"></a><span>        </span><a name="local-6989586621679280614"><a href="#local-6989586621679280614"><span class="hs-identifier">idecl</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InsData</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280619"><a href="#local-6989586621679280619"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280620"><a href="#local-6989586621679280620"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280619"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280620"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-325"></a><span>        </span><span class="hs-identifier">idecl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InsGData</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280621"><a href="#local-6989586621679280621"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280622"><a href="#local-6989586621679280622"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280621"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280622"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-326"></a><span>        </span><span class="hs-identifier">idecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Extensions.html#Derives"><span class="hs-identifier hs-type">Derives</span></a><span>
</span><a name="line-329"></a><span>        </span><a name="local-6989586621679280615"><a href="#local-6989586621679280615"><span class="hs-identifier">decl</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280623"><a href="#local-6989586621679280623"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280624"><a href="#local-6989586621679280624"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280623"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280624"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-330"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GDataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280625"><a href="#local-6989586621679280625"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280626"><a href="#local-6989586621679280626"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280625"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280626"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-331"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DataInsDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280627"><a href="#local-6989586621679280627"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280628"><a href="#local-6989586621679280628"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280627"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280628"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-332"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GDataInsDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280629"><a href="#local-6989586621679280629"><span class="hs-identifier">dn</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280630"><a href="#local-6989586621679280630"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280616"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679280629"><span class="hs-identifier hs-var">dn</span></a><span> </span><a href="#local-6989586621679280630"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-333"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">DerivDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280631"><a href="#local-6989586621679280631"><span class="hs-identifier">strategy</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280632"><a href="#local-6989586621679280632"><span class="hs-identifier">hd</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#addDerives"><span class="hs-identifier hs-var">addDerives</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679280631"><span class="hs-identifier hs-var">strategy</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679280617"><span class="hs-identifier hs-var">ir</span></a><span> </span><a href="#local-6989586621679280632"><span class="hs-identifier hs-var">hd</span></a><span class="hs-special">]</span><span>
</span><a name="line-334"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span>        </span><a name="local-6989586621679280616"><a href="#local-6989586621679280616"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679280633"><a href="#local-6989586621679280633"><span class="hs-identifier">dn</span></a></a><span> </span><a name="local-6989586621679280634"><a href="#local-6989586621679280634"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-special">[</span><a href="Hint.Extensions.html#addDerives"><span class="hs-identifier hs-var">addDerives</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679280633"><span class="hs-identifier hs-var">dn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679280635"><span class="hs-identifier hs-var">strategy</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679280617"><span class="hs-identifier hs-var">ir</span></a><span> </span><a href="#local-6989586621679280636"><span class="hs-identifier hs-var">rules</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Deriving</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280635"><a href="#local-6989586621679280635"><span class="hs-identifier">strategy</span></a></a><span> </span><a name="local-6989586621679280636"><a href="#local-6989586621679280636"><span class="hs-identifier">rules</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679280634"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">]</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span>        </span><a name="local-6989586621679280617"><a href="#local-6989586621679280617"><span class="hs-identifier">ir</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280637"><a href="#local-6989586621679280637"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280618"><span class="hs-identifier hs-var">ih</span></a><span> </span><a href="#local-6989586621679280637"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-339"></a><span>        </span><span class="hs-identifier">ir</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IParen</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280638"><a href="#local-6989586621679280638"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280617"><span class="hs-identifier hs-var">ir</span></a><span> </span><a href="#local-6989586621679280638"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span>        </span><a name="local-6989586621679280618"><a href="#local-6989586621679280618"><span class="hs-identifier">ih</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IHCon</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280639"><a href="#local-6989586621679280639"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#unqual"><span class="hs-identifier hs-var">unqual</span></a><span> </span><a href="#local-6989586621679280639"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-342"></a><span>        </span><span class="hs-identifier">ih</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IHInfix</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280640"><a href="#local-6989586621679280640"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#unqual"><span class="hs-identifier hs-var">unqual</span></a><span> </span><a href="#local-6989586621679280640"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-343"></a><span>        </span><span class="hs-identifier">ih</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IHParen</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280641"><a href="#local-6989586621679280641"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280618"><span class="hs-identifier hs-var">ih</span></a><span> </span><a href="#local-6989586621679280641"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-344"></a><span>        </span><span class="hs-identifier">ih</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IHApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280642"><a href="#local-6989586621679280642"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679280618"><span class="hs-identifier hs-var">ih</span></a><span> </span><a href="#local-6989586621679280642"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><a name="un"><a href="Hint.Extensions.html#un"><span class="hs-identifier">un</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><a name="hasT"><a href="Hint.Extensions.html#hasT"><span class="hs-identifier">hasT</span></a></a><span> </span><a name="local-6989586621679280643"><a href="#local-6989586621679280643"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679280644"><a href="#local-6989586621679280644"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679280644"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">asTypeOf</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679280643"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-349"></a><a name="hasT2"><a href="Hint.Extensions.html#hasT2"><span class="hs-identifier">hasT2</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679280645"><a href="#local-6989586621679280645"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679280646"><a href="#local-6989586621679280646"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><a href="#local-6989586621679280645"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">||^</span><span> </span><a href="Hint.Extensions.html#hasT"><span class="hs-identifier hs-var">hasT</span></a><span> </span><a href="#local-6989586621679280646"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-identifier">hasS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679280566"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280567"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679280567"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679280566"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-352"></a><a name="hasS"><a href="Hint.Extensions.html#hasS"><span class="hs-identifier">hasS</span></a></a><span> </span><a name="local-6989586621679280647"><a href="#local-6989586621679280647"><span class="hs-identifier">test</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="#local-6989586621679280647"><span class="hs-identifier hs-var">test</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">universeBi</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><a name="has"><a href="Hint.Extensions.html#has"><span class="hs-identifier">has</span></a></a><span> </span><a name="local-6989586621679280648"><a href="#local-6989586621679280648"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="#local-6989586621679280648"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">universeBi</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-comment">-- Only whole number fractions are permitted by NumDecimals extension.</span><span>
</span><a name="line-357"></a><span class="hs-comment">-- Anything not-whole raises an error.</span><span>
</span><a name="line-358"></a><span class="hs-identifier">isWholeFrac</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Literal</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-359"></a><a name="isWholeFrac"><a href="Hint.Extensions.html#isWholeFrac"><span class="hs-identifier">isWholeFrac</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Frac</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679280649"><a href="#local-6989586621679280649"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><a href="#local-6989586621679280649"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-360"></a><span class="hs-identifier">isWholeFrac</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-361"></a></pre></body></html>