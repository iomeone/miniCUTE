<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-
    Suggest the use of camelCase

    Only permit:
    _*[A-Za-z]*_*#*'*

    Apply this to things that would get exported by default only
    Also allow prop_ as it's a standard QuickCheck idiom
    Also allow case_ as it's a standard test-framework-th idiom
    Also allow test_ as it's a standard tasty-th idiom
    Also allow numbers separated by _
    Also don't suggest anything mentioned elsewhere in the module

&lt;TEST&gt;
data Yes = Foo | Bar'Test -- data Yes = Foo | BarTest
data Yes = Bar | Test_Bar -- data Yes = Bar | TestBar
data No = a :::: b
data Yes = Foo {bar_cap :: Int}
data No = FOO | BarBAR | BarBBar
yes_foo = yes_foo + yes_foo -- yesFoo = ...
no = 1 where yes_foo = 2
a -== b = 1
myTest = 1; my_test = 1
semiring'laws = 1 -- semiringLaws = ...
data Yes = FOO_A | Foo_B -- data Yes = FOO_A | FooB
case_foo = 1
test_foo = 1
cast_foo = 1 -- castFoo = ...
replicateM_ = 1
_foo__ = 1
section_1_1 = 1
runMutator# = 1
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.Naming</span><span class="hs-special">(</span><a href="Hint.Naming.html#namingHint"><span class="hs-identifier hs-var">namingHint</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RType</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-identifier">namingHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hint.Type.html#DeclHint"><span class="hs-identifier hs-type">DeclHint</span></a><span>
</span><a name="line-50"></a><a name="namingHint"><a href="Hint.Naming.html#namingHint"><span class="hs-identifier">namingHint</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272166"><a href="#local-6989586621679272166"><span class="hs-identifier">modu</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Naming.html#naming"><span class="hs-identifier hs-var">naming</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.Naming.html#getNames"><span class="hs-identifier hs-var">getNames</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#moduleDecls"><span class="hs-identifier hs-var">moduleDecls</span></a><span> </span><a href="#local-6989586621679272166"><span class="hs-identifier hs-var">modu</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-identifier">naming</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set.Set</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><a name="naming"><a href="Hint.Naming.html#naming"><span class="hs-identifier">naming</span></a></a><span> </span><a name="local-6989586621679272167"><a href="#local-6989586621679272167"><span class="hs-identifier">seen</span></a></a><span> </span><a name="local-6989586621679272168"><a href="#local-6989586621679272168"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Use camelCase&quot;</span><span> </span><a href="#local-6989586621679272171"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679272172"><span class="hs-identifier hs-var">x2'</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Bind</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679272168"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679272170"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679272169"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679272169"><a href="#local-6989586621679272169"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679272173"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><a href="#local-6989586621679272174"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679272173"><a href="#local-6989586621679272173"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">nubOrd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Hint.Naming.html#getNames"><span class="hs-identifier hs-var">getNames</span></a><span> </span><a href="#local-6989586621679272168"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679272174"><a href="#local-6989586621679272174"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="Hint.Naming.html#suggestName"><span class="hs-identifier hs-var">suggestName</span></a><span> </span><a href="#local-6989586621679272173"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272174"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679272167"><span class="hs-identifier hs-var">seen</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span>          </span><a name="local-6989586621679272170"><a href="#local-6989586621679272170"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Naming.html#replaceNames"><span class="hs-identifier hs-var">replaceNames</span></a><span> </span><a href="#local-6989586621679272169"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679272168"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-56"></a><span>          </span><a name="local-6989586621679272171"><a href="#local-6989586621679272171"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Naming.html#shorten"><span class="hs-identifier hs-var">shorten</span></a><span> </span><a href="#local-6989586621679272168"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-57"></a><span>          </span><a name="local-6989586621679272172"><a href="#local-6989586621679272172"><span class="hs-identifier">x2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Naming.html#shorten"><span class="hs-identifier hs-var">shorten</span></a><span> </span><a href="#local-6989586621679272170"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-identifier">shorten</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span>
</span><a name="line-61"></a><a name="shorten"><a href="Hint.Naming.html#shorten"><span class="hs-identifier">shorten</span></a></a><span> </span><a name="local-6989586621679272175"><a href="#local-6989586621679272175"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679272175"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-identifier hs-var">FunBind</span><span> </span><a name="local-6989586621679272180"><a href="#local-6989586621679272180"><span class="hs-identifier">sl</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><a name="local-6989586621679272181"><a href="#local-6989586621679272181"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679272182"><a href="#local-6989586621679272182"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679272183"><a href="#local-6989586621679272183"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679272184"><a href="#local-6989586621679272184"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">FunBind</span><span> </span><a href="#local-6989586621679272180"><span class="hs-identifier hs-var">sl</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679272177"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><a href="#local-6989586621679272181"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679272182"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679272183"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679272184"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier hs-var">PatBind</span><span> </span><a name="local-6989586621679272185"><a href="#local-6989586621679272185"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679272186"><a href="#local-6989586621679272186"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679272187"><a href="#local-6989586621679272187"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272177"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><a href="#local-6989586621679272185"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679272186"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679272187"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-64"></a><span>    </span><a name="local-6989586621679272188"><a href="#local-6989586621679272188"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272188"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-66"></a><span>        </span><a name="local-6989586621679272176"><a href="#local-6989586621679272176"><span class="hs-identifier">dots</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="HSE.Util.html#ellipses"><span class="hs-identifier hs-var">ellipses</span></a><span>
</span><a name="line-67"></a><span>        </span><a name="local-6989586621679272177"><a href="#local-6989586621679272177"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679272178"><a href="#local-6989586621679272178"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272178"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679272176"><span class="hs-identifier hs-var">dots</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-68"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679272179"><a href="#local-6989586621679272179"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272179"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Qualifier</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679272176"><span class="hs-identifier hs-var">dots</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679272176"><span class="hs-identifier hs-var">dots</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-identifier">getNames</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-72"></a><a name="getNames"><a href="Hint.Naming.html#getNames"><span class="hs-identifier">getNames</span></a></a><span> </span><a name="local-6989586621679272189"><a href="#local-6989586621679272189"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679272189"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-identifier hs-var">FunBind</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-identifier hs-var">PatBind</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-identifier hs-var">TypeDecl</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-identifier hs-var">DataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272195"><a href="#local-6989586621679272195"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679272197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">QualConDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272196"><a href="#local-6989586621679272196"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679272195"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679272197"><a href="#local-6989586621679272197"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679272191"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679272196"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-var">GDataDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272198"><a href="#local-6989586621679272198"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679272199"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">GadtDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272199"><a href="#local-6989586621679272199"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679272198"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier hs-var">TypeFamDecl</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier hs-var">DataFamDecl</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-identifier hs-var">ClassDecl</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272190"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>        </span><a name="local-6989586621679272190"><a href="#local-6989586621679272190"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679272189"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>        </span><a name="local-6989586621679272191"><a href="#local-6989586621679272191"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272192"><a href="#local-6989586621679272192"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679272192"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-86"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixConDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272193"><a href="#local-6989586621679272193"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679272193"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">RecDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272194"><a href="#local-6989586621679272194"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679272194"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">suggestName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-91"></a><a name="suggestName"><a href="Hint.Naming.html#suggestName"><span class="hs-identifier">suggestName</span></a></a><span> </span><a name="local-6989586621679272200"><a href="#local-6989586621679272200"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HSE.Match.html#isSym"><span class="hs-identifier hs-var">isSym</span></a><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679272201"><span class="hs-identifier hs-var">good</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-identifier hs-var">isLower</span><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-93"></a><span>        </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;prop_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;case_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;unit_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;test_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;spec_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;scprop_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;hprop_&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272203"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>        </span><a name="local-6989586621679272201"><a href="#local-6989586621679272201"><span class="hs-identifier">good</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-identifier hs-var">isAlphaNum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272202"><span class="hs-identifier hs-var">drp</span></a><span> </span><span class="hs-char">'_'</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272202"><span class="hs-identifier hs-var">drp</span></a><span> </span><span class="hs-char">'#'</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272202"><span class="hs-identifier hs-var">drp</span></a><span> </span><span class="hs-char">'\''</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679272202"><span class="hs-identifier hs-var">drp</span></a><span> </span><span class="hs-char">'_'</span><span> </span><a href="#local-6989586621679272200"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-97"></a><span>        </span><a name="local-6989586621679272202"><a href="#local-6989586621679272202"><span class="hs-identifier">drp</span></a></a><span> </span><a name="local-6989586621679272205"><a href="#local-6989586621679272205"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679272205"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>        </span><a name="local-6989586621679272203"><a href="#local-6989586621679272203"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679272206"><a href="#local-6989586621679272206"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272207"><span class="hs-identifier hs-var">us</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679272204"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679272208"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-100"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679272207"><a href="#local-6989586621679272207"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679272208"><a href="#local-6989586621679272208"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'_'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679272206"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>        </span><a name="local-6989586621679272204"><a href="#local-6989586621679272204"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679272209"><a href="#local-6989586621679272209"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679272209"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;'&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;_'&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272209"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-103"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679272210"><a href="#local-6989586621679272210"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679272211"><a href="#local-6989586621679272211"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679272212"><a href="#local-6989586621679272212"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679272210"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;_'&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isAlphaNum</span><span> </span><a href="#local-6989586621679272211"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span> </span><a href="#local-6989586621679272211"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679272204"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679272212"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-104"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679272213"><a href="#local-6989586621679272213"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679272214"><a href="#local-6989586621679272214"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isAlphaNum</span><span> </span><a href="#local-6989586621679272213"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272213"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679272204"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679272214"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-105"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272204"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679272214"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-106"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-identifier">replaceNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679272165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679272165"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-110"></a><a name="replaceNames"><a href="Hint.Naming.html#replaceNames"><span class="hs-identifier">replaceNames</span></a></a><span> </span><a name="local-6989586621679272215"><a href="#local-6989586621679272215"><span class="hs-identifier">rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">transformBi</span><span> </span><a href="#local-6989586621679272216"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679272216"><a href="#local-6989586621679272216"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679272217"><a href="#local-6989586621679272217"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Ident</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-6989586621679272217"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679272217"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679272215"><span class="hs-identifier hs-var">rep</span></a><span>
</span><a name="line-112"></a><span>          </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679272218"><a href="#local-6989586621679272218"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679272218"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-113"></a></pre></body></html>