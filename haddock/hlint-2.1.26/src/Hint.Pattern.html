<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns, PatternGuards #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-
    Improve the structure of code

&lt;TEST&gt;
yes x y = if a then b else if c then d else e -- yes x y ; | a = b ; | c = d ; | otherwise = e
x `yes` y = if a then b else if c then d else e -- x `yes` y ; | a = b ; | c = d ; | otherwise = e
no x y = if a then b else c
-- foo b | c &lt;- f b = c -- foo (f -&gt; c) = c
-- foo x y b z | c:cs &lt;- f g b = c -- foo x y (f g -&gt; c:cs) z = c
foo b | c &lt;- f b = c + b
foo b | c &lt;- f b = c where f = here
foo b | c &lt;- f b = c where foo = b
foo b | c &lt;- f b = c \
      | c &lt;- f b = c
foo x = yes x x where yes x y = if a then b else if c then d else e -- yes x y ; | a = b ; | c = d ; | otherwise = e
foo x | otherwise = y -- foo x = y
foo x = x + x where -- foo x = x + x
foo x | a = b | True = d -- foo x | a = b ; | otherwise = d
foo (Bar _ _ _ _) = x -- Bar{}
foo (Bar _ x _ _) = x
foo (Bar _ _) = x
foo = case f v of _ -&gt; x -- x
foo = case v of v -&gt; x -- x
foo = case v of z -&gt; z
foo = case v of _ | False -&gt; x
foo = case v of !True -&gt; x -- True
foo = case v of !(Just x) -&gt; x -- (Just x)
foo = case v of !(x : xs) -&gt; x -- (x:xs)
foo = case v of !1 -&gt; x -- 1
foo = case v of !x -&gt; x
foo = case v of !(I# x) -&gt; y -- (I# x)
foo = let ~x = 1 in y -- x
foo = let ~(x:xs) = y in z
foo = let !x = undefined in y
foo = let !(I# x) = 4 in x
foo = let !(Just x) = Nothing in 3
foo = 1 where f !False = 2 -- False
foo = 1 where !False = True
foo = 1 where g (Just !True) = Nothing -- True
foo = 1 where Just !True = Nothing
foo otherwise = 1 -- _
foo ~x = y -- x
{-# LANGUAGE Strict #-} foo ~x = y
foo !(x, y) = x -- (x, y)
foo ![x] = x -- [x]
foo !Bar { bar = x } = x -- Bar { bar = x }
l !(() :: ()) = x -- (() :: ())
foo x@_ = x -- x
foo x@Foo = x
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.Pattern</span><span class="hs-special">(</span><a href="Hint.Pattern.html#patternHint"><span class="hs-identifier hs-var">patternHint</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Function</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Tuple</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RType</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pattern</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Match</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">R</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RType</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Pattern</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Match</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-identifier">patternHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hint.Type.html#DeclHint"><span class="hs-identifier hs-type">DeclHint</span></a><span>
</span><a name="line-69"></a><a name="patternHint"><a href="Hint.Pattern.html#patternHint"><span class="hs-identifier">patternHint</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270479"><a href="#local-6989586621679270479"><span class="hs-identifier">modu</span></a></a><span> </span><a name="local-6989586621679270480"><a href="#local-6989586621679270480"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Hint.Pattern.html#hints"><span class="hs-identifier hs-var">hints</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">swap</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#asPattern"><span class="hs-identifier hs-var">asPattern</span></a><span> </span><a href="#local-6989586621679270480"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- PatBind (used in Let and Where) contains lazy-by-default patterns, everything else is strict</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#patHint"><span class="hs-identifier hs-var">patHint</span></a><span> </span><a href="#local-6989586621679270482"><span class="hs-identifier hs-var">strict</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270489"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">PatBind</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270489"><a href="#local-6989586621679270489"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679270480"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#patHint"><span class="hs-identifier hs-var">patHint</span></a><span> </span><a href="#local-6989586621679270482"><span class="hs-identifier hs-var">strict</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">transform</span><span> </span><a href="#local-6989586621679270481"><span class="hs-identifier hs-var">noPatBind</span></a><span> </span><a href="#local-6989586621679270480"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.Pattern.html#expHint"><span class="hs-identifier hs-var">expHint</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679270480"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>        </span><a name="local-6989586621679270481"><a href="#local-6989586621679270481"><span class="hs-identifier">noPatBind</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><a name="local-6989586621679270483"><a href="#local-6989586621679270483"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270484"><a href="#local-6989586621679270484"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679270485"><a href="#local-6989586621679270485"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PatBind</span><span> </span><a href="#local-6989586621679270483"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PWildCard</span><span> </span><a href="#local-6989586621679270483"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270484"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679270485"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-77"></a><span>        </span><span class="hs-identifier">noPatBind</span><span> </span><a name="local-6989586621679270486"><a href="#local-6989586621679270486"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270486"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>        </span><a name="local-6989586621679270482"><a href="#local-6989586621679270482"><span class="hs-identifier">strict</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Strict&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270488"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">LanguagePragma</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270487"><a href="#local-6989586621679270487"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HSE.Util.html#modulePragmas"><span class="hs-identifier hs-var">modulePragmas</span></a><span> </span><a href="#local-6989586621679270479"><span class="hs-identifier hs-var">modu</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270488"><a href="#local-6989586621679270488"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679270487"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">hints</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Refactoring</span><span> </span><span class="hs-identifier hs-type">R.SrcSpan</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-83"></a><a name="hints"><a href="Hint.Pattern.html#hints"><span class="hs-identifier">hints</span></a></a><span> </span><a name="local-6989586621679270490"><a href="#local-6989586621679270490"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a name="local-6989586621679270491"><a href="#local-6989586621679270491"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679270492"><a href="#local-6989586621679270492"><span class="hs-identifier">rtype</span></a></a><span> </span><a name="local-6989586621679270493"><a href="#local-6989586621679270493"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a name="local-6989586621679270494"><a href="#local-6989586621679270494"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679270495"><a href="#local-6989586621679270495"><span class="hs-identifier">bod</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270496"><a href="#local-6989586621679270496"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679270499"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270490"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-string">&quot;Use guards&quot;</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270491"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679270492"><span class="hs-identifier hs-var">rtype</span></a><span> </span><a href="#local-6989586621679270493"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><a href="#local-6989586621679270494"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679270499"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270496"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270510"><span class="hs-identifier hs-var">refactoring</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679270497"><a href="#local-6989586621679270497"><span class="hs-identifier">rawGuards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Pattern.html#asGuards"><span class="hs-identifier hs-var">asGuards</span></a><span> </span><a href="#local-6989586621679270495"><span class="hs-identifier hs-var">bod</span></a><span>
</span><a name="line-86"></a><span>          </span><a name="local-6989586621679270498"><a href="#local-6989586621679270498"><span class="hs-identifier">mkGuard</span></a></a><span> </span><a name="local-6989586621679270512"><a href="#local-6989586621679270512"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Qualifier</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679270512"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span>          </span><a name="local-6989586621679270499"><a href="#local-6989586621679270499"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="#local-6989586621679270498"><span class="hs-identifier hs-var">mkGuard</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270497"><span class="hs-identifier hs-var">rawGuards</span></a><span>
</span><a name="line-88"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679270500"><a href="#local-6989586621679270500"><span class="hs-identifier">lhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679270501"><a href="#local-6989586621679270501"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unzip</span><span> </span><a href="#local-6989586621679270497"><span class="hs-identifier hs-var">rawGuards</span></a><span>
</span><a name="line-89"></a><span>          </span><a name="local-6989586621679270502"><a href="#local-6989586621679270502"><span class="hs-identifier">mkTemplate</span></a></a><span> </span><a name="local-6989586621679270513"><a href="#local-6989586621679270513"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679270514"><a href="#local-6989586621679270514"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>            </span><span class="hs-comment">-- Check if the expression has been injected or is natural</span><span>
</span><a name="line-91"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679270515"><a href="#local-6989586621679270515"><span class="hs-identifier">checkAn</span></a></a><span> </span><a name="local-6989586621679270516"><a href="#local-6989586621679270516"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679270517"><a href="#local-6989586621679270517"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679270516"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679270516"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679270513"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270517"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270516"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679270515"><span class="hs-identifier hs-var">checkAn</span></a><span> </span><a href="#local-6989586621679270514"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">[</span><span class="hs-char">'1'</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-char">'9'</span><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span>          </span><a name="local-6989586621679270503"><a href="#local-6989586621679270503"><span class="hs-identifier">patSubts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679270493"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-94"></a><span>                       </span><span class="hs-special">[</span><a name="local-6989586621679270518"><a href="#local-6989586621679270518"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679270518"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Substitution doesn't work properly for PatBinds</span><span>
</span><a name="line-95"></a><span>                                       </span><span class="hs-comment">-- This will probably produce</span><span>
</span><a name="line-96"></a><span>                                       </span><span class="hs-comment">-- unexpected results if the pattern</span><span>
</span><a name="line-97"></a><span>                                       </span><span class="hs-comment">-- contains any template variables</span><span>
</span><a name="line-98"></a><span>                       </span><a name="local-6989586621679270519"><a href="#local-6989586621679270519"><span class="hs-identifier">ps</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679270502"><span class="hs-identifier hs-var">mkTemplate</span></a><span> </span><span class="hs-string">&quot;p100&quot;</span><span> </span><a href="#local-6989586621679270519"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-99"></a><span>          </span><a name="local-6989586621679270504"><a href="#local-6989586621679270504"><span class="hs-identifier">guardSubts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270502"><span class="hs-identifier hs-var">mkTemplate</span></a><span> </span><span class="hs-string">&quot;g100&quot;</span><span> </span><a href="#local-6989586621679270500"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-100"></a><span>          </span><a name="local-6989586621679270505"><a href="#local-6989586621679270505"><span class="hs-identifier">exprSubts</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270502"><span class="hs-identifier hs-var">mkTemplate</span></a><span> </span><span class="hs-string">&quot;e100&quot;</span><span> </span><a href="#local-6989586621679270501"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-101"></a><span>          </span><a name="local-6989586621679270506"><a href="#local-6989586621679270506"><span class="hs-identifier">templateGuards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679270498"><span class="hs-identifier hs-var">mkGuard</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">on</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679270507"><span class="hs-identifier hs-var">toString</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270504"><span class="hs-identifier hs-var">guardSubts</span></a><span> </span><a href="#local-6989586621679270505"><span class="hs-identifier hs-var">exprSubts</span></a><span>
</span><a name="line-102"></a><span>          </span><a name="local-6989586621679270507"><a href="#local-6989586621679270507"><span class="hs-identifier">toString</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679270520"><a href="#local-6989586621679270520"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270520"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-103"></a><span>          </span><span class="hs-identifier">toString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679270521"><a href="#local-6989586621679270521"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><a href="#local-6989586621679270521"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-104"></a><span>          </span><a name="local-6989586621679270508"><a href="#local-6989586621679270508"><span class="hs-identifier">template</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">ideaTo</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679270490"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270491"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679270492"><span class="hs-identifier hs-var">rtype</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679270507"><span class="hs-identifier hs-var">toString</span></a><span> </span><a href="#local-6989586621679270503"><span class="hs-identifier hs-var">patSubts</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><a href="#local-6989586621679270494"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679270506"><span class="hs-identifier hs-var">templateGuards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270496"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679270511"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">R.SrcSpan</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">R.SrcSpan</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span>          </span><a name="local-6989586621679270509"><a href="#local-6989586621679270509"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rights</span><span>
</span><a name="line-107"></a><span>          </span><a name="local-6989586621679270510"><a href="#local-6989586621679270510"><span class="hs-identifier">refactoring</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><a href="#local-6989586621679270492"><span class="hs-identifier hs-var">rtype</span></a><span> </span><span class="hs-special">(</span><a href="Refact.html#toRefactSrcSpan"><span class="hs-identifier hs-var">toRefactSrcSpan</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">srcInfoSpan</span><span> </span><a href="#local-6989586621679270491"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679270509"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270503"><span class="hs-identifier hs-var">patSubts</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679270509"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270504"><span class="hs-identifier hs-var">guardSubts</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679270509"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270505"><span class="hs-identifier hs-var">exprSubts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270508"><span class="hs-identifier hs-var">template</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">{-
-- Do not suggest view patterns, they aren't something everyone likes sufficiently
hints gen (Pattern pats (GuardedRhss _ [GuardedRhs _ [Generator _ pat (App _ op (view -&gt; Var_ p))] bod]) bind)
    | Just i &lt;- findIndex (=~= (toNamed p :: Pat_)) pats
    , p `notElem` (vars bod ++ vars bind)
    , vars op `disjoint` decsBind, pvars pats `disjoint` vars op, pvars pat `disjoint` pvars pats
    = [gen &quot;Use view patterns&quot; $
       Pattern (take i pats ++ [PParen an $ PViewPat an op pat] ++ drop (i+1) pats) (UnGuardedRhs an bod) bind]
    where
        decsBind = nub $ concatMap declBind $ childrenBi bind
-}</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-identifier">hints</span><span> </span><a name="local-6989586621679270522"><a href="#local-6989586621679270522"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a name="local-6989586621679270523"><a href="#local-6989586621679270523"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679270524"><a href="#local-6989586621679270524"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679270525"><a href="#local-6989586621679270525"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679270526"><a href="#local-6989586621679270526"><span class="hs-identifier">test</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621679270527"><a href="#local-6989586621679270527"><span class="hs-identifier">bod</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679270528"><a href="#local-6989586621679270528"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679270526"><span class="hs-identifier hs-var">test</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;otherwise&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;True&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270522"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-string">&quot;Redundant guard&quot;</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270523"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679270524"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679270525"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679270527"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270528"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Delete</span><span> </span><span class="hs-identifier hs-var">Stmt</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270526"><span class="hs-identifier hs-var">test</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">hints</span><span> </span><a name="local-6989586621679270529"><a href="#local-6989586621679270529"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a name="local-6989586621679270530"><a href="#local-6989586621679270530"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679270531"><a href="#local-6989586621679270531"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679270532"><a href="#local-6989586621679270532"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679270533"><a href="#local-6989586621679270533"><span class="hs-identifier">bod</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679270534"><a href="#local-6989586621679270534"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679270535"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270534"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-126"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270529"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-string">&quot;Redundant where&quot;</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270530"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679270531"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679270532"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679270533"><span class="hs-identifier hs-var">bod</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>        </span><a name="local-6989586621679270535"><a href="#local-6989586621679270535"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BDecls</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270536"><a href="#local-6989586621679270536"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679270536"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-129"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">IPBinds</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270537"><a href="#local-6989586621679270537"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679270537"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">hints</span><span> </span><a name="local-6989586621679270538"><a href="#local-6989586621679270538"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a name="local-6989586621679270539"><a href="#local-6989586621679270539"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679270540"><a href="#local-6989586621679270540"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679270541"><a href="#local-6989586621679270541"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsnoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679270542"><a href="#local-6989586621679270542"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679270543"><a href="#local-6989586621679270543"><span class="hs-identifier">test</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621679270544"><a href="#local-6989586621679270544"><span class="hs-identifier">bod</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679270545"><a href="#local-6989586621679270545"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679270543"><span class="hs-identifier hs-var">test</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;True&quot;</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270538"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-string">&quot;Use otherwise&quot;</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270539"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679270540"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679270541"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GuardedRhss</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679270542"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">GuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Qualifier</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;otherwise&quot;</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679270544"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270545"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270543"><span class="hs-identifier hs-var">test</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;otherwise&quot;</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-identifier">hints</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-identifier">asGuards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Exp</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Exp</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><a name="asGuards"><a href="Hint.Pattern.html#asGuards"><span class="hs-identifier">asGuards</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Paren</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270546"><a href="#local-6989586621679270546"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Pattern.html#asGuards"><span class="hs-identifier hs-var">asGuards</span></a><span> </span><a href="#local-6989586621679270546"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-140"></a><span class="hs-identifier">asGuards</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">If</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270547"><a href="#local-6989586621679270547"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679270548"><a href="#local-6989586621679270548"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679270549"><a href="#local-6989586621679270549"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679270547"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679270548"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Hint.Pattern.html#asGuards"><span class="hs-identifier hs-var">asGuards</span></a><span> </span><a href="#local-6989586621679270549"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-141"></a><span class="hs-identifier">asGuards</span><span> </span><a name="local-6989586621679270550"><a href="#local-6989586621679270550"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;otherwise&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679270550"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">data</span><span> </span><a name="Pattern"><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier">Pattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Pattern"><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier">Pattern</span></a></a><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span> </span><span class="hs-identifier hs-type">R.RType</span><span> </span><span class="hs-special">[</span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Rhs</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Binds</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- Invariant: Number of patterns may not change</span><span>
</span><a name="line-147"></a><span class="hs-identifier">asPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Refactoring</span><span> </span><span class="hs-identifier hs-type">R.SrcSpan</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-148"></a><a name="asPattern"><a href="Hint.Pattern.html#asPattern"><span class="hs-identifier">asPattern</span></a></a><span> </span><a name="local-6989586621679270551"><a href="#local-6989586621679270551"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679270552"><span class="hs-identifier hs-var">decl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679270551"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679270554"><span class="hs-identifier hs-var">alt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679270551"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>        </span><a name="local-6989586621679270552"><a href="#local-6989586621679270552"><span class="hs-identifier">decl</span></a></a><span> </span><a name="local-6989586621679270555"><a href="#local-6989586621679270555"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><a name="local-6989586621679270556"><a href="#local-6989586621679270556"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679270557"><a href="#local-6989586621679270557"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679270558"><a href="#local-6989586621679270558"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270559"><a href="#local-6989586621679270559"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270556"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">Bind</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270557"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679270558"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270559"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679270560"><a href="#local-6989586621679270560"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679270561"><a href="#local-6989586621679270561"><span class="hs-identifier">pat</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621679270562"><a href="#local-6989586621679270562"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270563"><a href="#local-6989586621679270563"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270564"><a href="#local-6989586621679270564"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679270560"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621679270555"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatBind</span><span> </span><a href="#local-6989586621679270556"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679270561"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679270562"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270563"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270564"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270565"><a href="#local-6989586621679270565"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679270553"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679270565"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-152"></a><span>        </span><span class="hs-identifier">decl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span>        </span><a name="local-6989586621679270553"><a href="#local-6989586621679270553"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679270566"><a href="#local-6989586621679270566"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><a name="local-6989586621679270567"><a href="#local-6989586621679270567"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679270568"><a href="#local-6989586621679270568"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679270569"><a href="#local-6989586621679270569"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679270570"><a href="#local-6989586621679270570"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270571"><a href="#local-6989586621679270571"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270567"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">R.Match</span><span> </span><a href="#local-6989586621679270569"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679270570"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270571"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679270572"><a href="#local-6989586621679270572"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270573"><a href="#local-6989586621679270573"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679270574"><a href="#local-6989586621679270574"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270575"><a href="#local-6989586621679270575"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270576"><a href="#local-6989586621679270576"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679270572"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621679270566"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span> </span><a href="#local-6989586621679270567"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679270568"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679270573"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679270574"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270575"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270576"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>        </span><span class="hs-identifier">match</span><span> </span><a name="local-6989586621679270577"><a href="#local-6989586621679270577"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixMatch</span><span> </span><a name="local-6989586621679270578"><a href="#local-6989586621679270578"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679270579"><a href="#local-6989586621679270579"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679270580"><a href="#local-6989586621679270580"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679270581"><a href="#local-6989586621679270581"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679270582"><a href="#local-6989586621679270582"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270583"><a href="#local-6989586621679270583"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270578"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">R.Match</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679270579"><span class="hs-identifier hs-var">p</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679270581"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270582"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270583"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679270584"><a href="#local-6989586621679270584"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679270585"><a href="#local-6989586621679270585"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679270586"><a href="#local-6989586621679270586"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270587"><a href="#local-6989586621679270587"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270588"><a href="#local-6989586621679270588"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270589"><a href="#local-6989586621679270589"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679270584"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621679270577"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixMatch</span><span> </span><a href="#local-6989586621679270578"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679270585"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679270580"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679270586"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621679270587"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270588"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679270589"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>        </span><a name="local-6989586621679270554"><a href="#local-6989586621679270554"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621679270590"><a href="#local-6989586621679270590"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Alt</span><span> </span><a name="local-6989586621679270591"><a href="#local-6989586621679270591"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679270592"><a href="#local-6989586621679270592"><span class="hs-identifier">pat</span></a></a><span> </span><a name="local-6989586621679270593"><a href="#local-6989586621679270593"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270594"><a href="#local-6989586621679270594"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><a href="#local-6989586621679270591"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">R.Match</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270592"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679270593"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270594"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679270595"><a href="#local-6989586621679270595"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679270596"><a href="#local-6989586621679270596"><span class="hs-identifier">pat</span></a></a><span class="hs-special">]</span><span> </span><a name="local-6989586621679270597"><a href="#local-6989586621679270597"><span class="hs-identifier">rhs</span></a></a><span> </span><a name="local-6989586621679270598"><a href="#local-6989586621679270598"><span class="hs-identifier">bind</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679270599"><a href="#local-6989586621679270599"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679270595"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621679270590"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Alt</span><span> </span><a href="#local-6989586621679270591"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679270596"><span class="hs-identifier hs-var">pat</span></a><span> </span><a href="#local-6989586621679270597"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679270598"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- First Bool is if Strict is a language extension</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- Second Bool is if this pattern in this context is going to be evaluated strictly</span><span>
</span><a name="line-160"></a><span class="hs-identifier">patHint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-161"></a><a name="patHint"><a href="Hint.Pattern.html#patHint"><span class="hs-identifier">patHint</span></a></a><span> </span><a name="local-6989586621679270600"><a href="#local-6989586621679270600"><span class="hs-identifier">lang</span></a></a><span> </span><a name="local-6989586621679270601"><a href="#local-6989586621679270601"><span class="hs-identifier">strict</span></a></a><span> </span><a name="local-6989586621679270602"><a href="#local-6989586621679270602"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PApp</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270603"><a href="#local-6989586621679270603"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679270604"><a href="#local-6989586621679270604"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679270604"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><a href="HSE.Util.html#isPWildCard"><span class="hs-identifier hs-var">isPWildCard</span></a><span> </span><a href="#local-6989586621679270604"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Use record patterns&quot;</span><span> </span><a href="#local-6989586621679270602"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PRec</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679270603"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">R.Pattern</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270602"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">PRec</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679270603"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span class="hs-identifier">patHint</span><span> </span><a name="local-6989586621679270605"><a href="#local-6989586621679270605"><span class="hs-identifier">lang</span></a></a><span> </span><a name="local-6989586621679270606"><a href="#local-6989586621679270606"><span class="hs-identifier">strict</span></a></a><span> </span><a name="local-6989586621679270607"><a href="#local-6989586621679270607"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270608"><a href="#local-6989586621679270608"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679270608"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;otherwise&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Used otherwise as a pattern&quot;</span><span> </span><a href="#local-6989586621679270607"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PWildCard</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-identifier">patHint</span><span> </span><a name="local-6989586621679270609"><a href="#local-6989586621679270609"><span class="hs-identifier">lang</span></a></a><span> </span><a name="local-6989586621679270610"><a href="#local-6989586621679270610"><span class="hs-identifier">strict</span></a></a><span> </span><a name="local-6989586621679270611"><a href="#local-6989586621679270611"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PBangPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270612"><a href="#local-6989586621679270612"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679270610"><span class="hs-identifier hs-var">strict</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679270613"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270612"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Redundant bang pattern&quot;</span><span> </span><a href="#local-6989586621679270611"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679270612"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270614"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679270613"><a href="#local-6989586621679270613"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PParen</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270615"><a href="#local-6989586621679270615"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270613"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270615"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-167"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PAsPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270616"><a href="#local-6989586621679270616"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270613"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270616"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-168"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PLit</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-169"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-170"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PInfixApp</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-171"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PTuple</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-172"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PList</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-173"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PRec</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-174"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PatTypeSig</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270617"><a href="#local-6989586621679270617"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270613"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270617"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-175"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-176"></a><span>          </span><a name="local-6989586621679270614"><a href="#local-6989586621679270614"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">R.Pattern</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270611"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270612"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-177"></a><span class="hs-identifier">patHint</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679270618"><a href="#local-6989586621679270618"><span class="hs-identifier">strict</span></a></a><span> </span><a name="local-6989586621679270619"><a href="#local-6989586621679270619"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PIrrPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270620"><a href="#local-6989586621679270620"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679270621"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270620"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Redundant irrefutable pattern&quot;</span><span> </span><a href="#local-6989586621679270619"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679270620"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270622"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679270621"><a href="#local-6989586621679270621"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PParen</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270623"><a href="#local-6989586621679270623"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270621"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270623"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-179"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PAsPat</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270624"><a href="#local-6989586621679270624"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679270621"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679270624"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-180"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PWildCard</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-181"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier hs-var">PVar</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-182"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-183"></a><span>          </span><a name="local-6989586621679270622"><a href="#local-6989586621679270622"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">R.Pattern</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270619"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270620"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-184"></a><span class="hs-identifier">patHint</span><span> </span><a name="local-6989586621679270625"><a href="#local-6989586621679270625"><span class="hs-identifier">lang</span></a></a><span> </span><a name="local-6989586621679270626"><a href="#local-6989586621679270626"><span class="hs-identifier">strict</span></a></a><span> </span><a name="local-6989586621679270627"><a href="#local-6989586621679270627"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PAsPat</span><span> </span><a name="local-6989586621679270628"><a href="#local-6989586621679270628"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679270629"><a href="#local-6989586621679270629"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier hs-var">PWildCard</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Redundant as-pattern&quot;</span><span> </span><a href="#local-6989586621679270627"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679270629"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><span class="hs-identifier">patHint</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">expHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-189"></a><a name="expHint"><a href="Hint.Pattern.html#expHint"><span class="hs-identifier">expHint</span></a></a><span> </span><a name="local-6989586621679270630"><a href="#local-6989586621679270630"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Case</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Alt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">PWildCard</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270631"><a href="#local-6989586621679270631"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Redundant case&quot;</span><span> </span><a href="#local-6989586621679270630"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679270631"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270632"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>    </span><a name="local-6989586621679270632"><a href="#local-6989586621679270632"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270630"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270631"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-193"></a><span class="hs-identifier">expHint</span><span> </span><a name="local-6989586621679270633"><a href="#local-6989586621679270633"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Case</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270634"><a href="#local-6989586621679270634"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Alt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270635"><a href="#local-6989586621679270635"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679270636"><a href="#local-6989586621679270636"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679270634"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">=~=</span><span> </span><span class="hs-identifier hs-var">UnQual</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679270635"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-195"></a><span>      </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Redundant case&quot;</span><span> </span><a href="#local-6989586621679270633"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679270636"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679270637"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-197"></a><span>    </span><a name="local-6989586621679270637"><a href="#local-6989586621679270637"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270633"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679270636"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;x&quot;</span><span>
</span><a name="line-198"></a><span class="hs-identifier">expHint</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-199"></a></pre></body></html>