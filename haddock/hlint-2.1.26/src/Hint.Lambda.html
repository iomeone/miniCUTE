<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns, PatternGuards #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-
    Concept:
    Remove all the lambdas you can be inserting only sections
    Never create a right section with +-# as the operator (they are misparsed)

    Rules:
    fun a = \x -&gt; y  -- promote lambdas, provided no where's outside the lambda
    fun x = y x  -- eta reduce, x /= mr and foo /= symbol
    \x -&gt; y x  -- eta reduce
    ((#) x) ==&gt; (x #)  -- rotate operators
    (flip op x) ==&gt; (`op` x)  -- rotate operators
    \x y -&gt; x + y ==&gt; (+)  -- insert operator
    \x y -&gt; op y x ==&gt; flip op
    \x -&gt; x + y ==&gt; (+ y)  -- insert section,
    \x -&gt; op x y ==&gt; (`op` y)  -- insert section
    \x -&gt; y + x ==&gt; (y +)  -- insert section
    \x -&gt; \y -&gt; ... ==&gt; \x y -- lambda compression
    \x -&gt; (x +) ==&gt; (+) -- operator reduction

&lt;TEST&gt;
f a = \x -&gt; x + x -- f a x = x + x
f a = \a -&gt; a + a -- f _ a = a + a
f a = \x -&gt; x + x where _ = test
f (test -&gt; a) = \x -&gt; x + x
f = \x -&gt; x + x -- f x = x + x
fun x y z = f x y z -- fun = f
fun x y z = f x x y z -- fun x = f x x
fun x y z = f g z -- fun x y = f g
fun mr = y mr
fun x = f . g $ x -- fun = f . g
f = foo (\y -&gt; g x . h $ y) -- g x . h
f = foo (\y -&gt; g x . h $ y) -- @Message Avoid lambda
f = foo ((*) x) -- (x *)
f = (*) x
f = foo (flip op x) -- (`op` x)
f = foo (flip op x) -- @Message Use section
foo x = bar (\ d -&gt; search d table) -- (`search` table)
foo x = bar (\ d -&gt; search d table) -- @Message Avoid lambda using `infix`
f = flip op x
f = foo (flip (*) x) -- (* x)
f = foo (flip (-) x)
f = foo (\x y -&gt; fun x y) -- @Warning fun
f = foo (\x y -&gt; x + y) -- (+)
f = foo (\x -&gt; x * y) -- @Suggestion (* y)
f = foo (\x -&gt; x # y)
f = foo (\x -&gt; \y -&gt; x x y y) -- \x y -&gt; x x y y
f = foo (\x -&gt; \x -&gt; foo x x) -- \_ x -&gt; foo x x
f = foo (\(foo -&gt; x) -&gt; \y -&gt; x x y y)
f = foo (\(x:xs) -&gt; \x -&gt; foo x x) -- \(_:xs) x -&gt; foo x x
f = foo (\x -&gt; \y -&gt; \z -&gt; x x y y z z) -- \x y z -&gt; x x y y z z
x ! y = fromJust $ lookup x y
f = foo (\i -&gt; writeIdea (getClass i) i)
f = bar (flip Foo.bar x) -- (`Foo.bar` x)
f = a b (\x -&gt; c x d)  -- (`c` d)
yes = \x -&gt; a x where -- a
yes = \x y -&gt; op y x where -- flip op
f = \y -&gt; nub $ reverse y where -- nub . reverse
f = \z -&gt; foo $ bar $ baz z where -- foo . bar . baz
f = \z -&gt; foo $ bar x $ baz z where -- foo . bar x . baz
f = \z -&gt; foo $ z $ baz z where
f = \x -&gt; bar map (filter x) where -- bar map . filter
f = bar &amp;+&amp; \x -&gt; f (g x)
foo = [\column -&gt; set column [treeViewColumnTitle := printf &quot;%s (match %d)&quot; name (length candidnates)]]
foo = [\x -&gt; x]
foo = [\m x -&gt; insert x x m]
foo a b c = bar (flux ++ quux) c where flux = a -- foo a b = bar (flux ++ quux)
foo a b c = bar (flux ++ quux) c where flux = c
yes = foo (\x -&gt; Just x) -- @Warning Just
foo = bar (\x -&gt; (x `f`)) -- f
baz = bar (\x -&gt; (x +)) -- (+)
yes = blah (\ x -&gt; case x of A -&gt; a; B -&gt; b) -- \ case A -&gt; a; B -&gt; b
no = blah (\ x -&gt; case x of A -&gt; a x; B -&gt; b x)
yes = blah (\ x -&gt; (y, x, z+q)) -- (y, , z+q)
yes = blah (\ x -&gt; (y, x, z+x))
tmp = map (\ x -&gt; runST $ action x)
yes = map (\f -&gt; dataDir &lt;/&gt; f) dataFiles -- (dataDir &lt;/&gt;)
{-# LANGUAGE TypeApplications #-}; noBug545 = coerce ((&lt;&gt;) @[a])
{-# LANGUAGE QuasiQuotes #-}; authOAuth2 name = authOAuth2Widget [whamlet|Login via #{name}|] name
{-# LANGUAGE QuasiQuotes #-}; authOAuth2 = foo (\name -&gt; authOAuth2Widget [whamlet|Login via #{name}|] name)
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.Lambda</span><span class="hs-special">(</span><a href="Hint.Lambda.html#lambdaHint"><span class="hs-identifier hs-var">lambdaHint</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Util.html"><span class="hs-identifier">Hint.Util</span></a><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RType</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Match</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-identifier">lambdaHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hint.Type.html#DeclHint"><span class="hs-identifier hs-type">DeclHint</span></a><span>
</span><a name="line-98"></a><a name="lambdaHint"><a href="Hint.Lambda.html#lambdaHint"><span class="hs-identifier">lambdaHint</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278339"><a href="#local-6989586621679278339"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Hint.Lambda.html#lambdaExp"><span class="hs-identifier hs-var">lambdaExp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Util.html#universeParentBi"><span class="hs-identifier hs-var">universeParentBi</span></a><span> </span><a href="#local-6989586621679278339"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.Lambda.html#lambdaDecl"><span class="hs-identifier hs-var">lambdaDecl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679278339"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">lambdaDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-102"></a><a name="lambdaDecl"><a href="Hint.Lambda.html#lambdaDecl"><span class="hs-identifier">lambdaDecl</span></a></a><span> </span><span class="hs-special">(</span><a href="HSE.Util.html#toFunBind"><span class="hs-identifier hs-var">toFunBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679278340"><a href="#local-6989586621679278340"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">FunBind</span><span> </span><a name="local-6989586621679278341"><a href="#local-6989586621679278341"><span class="hs-identifier">loc1</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Match</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278342"><a href="#local-6989586621679278342"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679278343"><a href="#local-6989586621679278343"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a name="local-6989586621679278344"><a href="#local-6989586621679278344"><span class="hs-identifier">loc2</span></a></a><span> </span><a name="local-6989586621679278345"><a href="#local-6989586621679278345"><span class="hs-identifier">bod</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679278346"><a href="#local-6989586621679278346"><span class="hs-identifier">bind</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><a href="#local-6989586621679278346"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">,</span><span> </span><a href="HSE.Util.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#fromParen"><span class="hs-identifier hs-var">fromParen</span></a><span> </span><a href="#local-6989586621679278345"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-104"></a><span>      </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Redundant lambda&quot;</span><span> </span><a href="#local-6989586621679278340"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278349"><span class="hs-identifier hs-var">gen</span></a><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679278345"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Decl</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278340"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278357"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621679278358"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679278352"><span class="hs-identifier hs-var">pats2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">,</span><span> </span><a href="HSE.All.html#pvars"><span class="hs-identifier hs-var">pvars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679278352"><span class="hs-identifier hs-var">pats2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">disjoint</span><span class="hs-special">`</span><span> </span><a href="HSE.All.html#varss"><span class="hs-identifier hs-var">varss</span></a><span> </span><a href="#local-6989586621679278346"><span class="hs-identifier hs-var">bind</span></a><span>
</span><a name="line-106"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-string">&quot;Eta reduce&quot;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">reform</span></a><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679278345"><span class="hs-identifier hs-var">bod</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">reform</span></a><span> </span><a href="#local-6989586621679278352"><span class="hs-identifier hs-var">pats2</span></a><span> </span><a href="#local-6989586621679278353"><span class="hs-identifier hs-var">bod2</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- Disabled, see apply-refact #3</span><span>
</span><a name="line-108"></a><span>              </span><span class="hs-comment">-- Replace Decl (toSS $ reform pats bod) s2 t2]]</span><span>
</span><a name="line-109"></a><span>            </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679278347"><a href="#local-6989586621679278347"><span class="hs-identifier">reform</span></a></a><span> </span><a name="local-6989586621679278359"><a href="#local-6989586621679278359"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278360"><a href="#local-6989586621679278360"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">FunBind</span><span> </span><a href="#local-6989586621679278348"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Match</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278342"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679278359"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnGuardedRhs</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278360"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span>              </span><a name="local-6989586621679278348"><a href="#local-6989586621679278348"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#setSpanInfoEnd"><span class="hs-identifier hs-var">setSpanInfoEnd</span></a><span> </span><a href="#local-6989586621679278341"><span class="hs-identifier hs-var">loc1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">srcSpanEnd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">srcInfoSpan</span><span> </span><a href="#local-6989586621679278344"><span class="hs-identifier hs-var">loc2</span></a><span>
</span><a name="line-112"></a><span>              </span><a name="local-6989586621679278349"><a href="#local-6989586621679278349"><span class="hs-identifier">gen</span></a></a><span> </span><a name="local-6989586621679278361"><a href="#local-6989586621679278361"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">reform</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Hint.Lambda.html#fromLambda"><span class="hs-identifier hs-var">fromLambda</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Lambda</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278361"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-113"></a><span>              </span><span class="hs-special">(</span><a name="local-6989586621679278350"><a href="#local-6989586621679278350"><span class="hs-identifier">finalpats</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679278351"><a href="#local-6989586621679278351"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#fromLambda"><span class="hs-identifier hs-var">fromLambda</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Lambda</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679278345"><span class="hs-identifier hs-var">bod</span></a><span>
</span><a name="line-114"></a><span>              </span><span class="hs-special">(</span><a name="local-6989586621679278352"><a href="#local-6989586621679278352"><span class="hs-identifier">pats2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679278353"><a href="#local-6989586621679278353"><span class="hs-identifier">bod2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#etaReduce"><span class="hs-identifier hs-var">etaReduce</span></a><span> </span><a href="#local-6989586621679278343"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679278345"><span class="hs-identifier hs-var">bod</span></a><span>
</span><a name="line-115"></a><span>              </span><a name="local-6989586621679278354"><a href="#local-6989586621679278354"><span class="hs-identifier">template</span></a></a><span> </span><a name="local-6989586621679278362"><a href="#local-6989586621679278362"><span class="hs-identifier">fps</span></a></a><span> </span><a name="local-6989586621679278363"><a href="#local-6989586621679278363"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679278347"><span class="hs-identifier hs-var">reform</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679278355"><span class="hs-identifier hs-var">munge</span></a><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679278362"><span class="hs-identifier hs-var">fps</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;body&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>              </span><span class="hs-identifier">munge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span>
</span><a name="line-117"></a><span>              </span><a name="local-6989586621679278355"><a href="#local-6989586621679278355"><span class="hs-identifier">munge</span></a></a><span> </span><a name="local-6989586621679278364"><a href="#local-6989586621679278364"><span class="hs-identifier">ident</span></a></a><span> </span><a name="local-6989586621679278365"><a href="#local-6989586621679278365"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PWildCard</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278365"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-118"></a><span>              </span><span class="hs-identifier">munge</span><span> </span><a name="local-6989586621679278366"><a href="#local-6989586621679278366"><span class="hs-identifier">ident</span></a></a><span> </span><a name="local-6989586621679278367"><a href="#local-6989586621679278367"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679278367"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679278367"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679278366"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>              </span><a name="local-6989586621679278356"><a href="#local-6989586621679278356"><span class="hs-identifier">subts</span></a></a><span> </span><a name="local-6989586621679278368"><a href="#local-6989586621679278368"><span class="hs-identifier">fps</span></a></a><span> </span><a name="local-6989586621679278369"><a href="#local-6989586621679278369"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;body&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278369"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679278370"><a href="#local-6989586621679278370"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679278371"><a href="#local-6989586621679278371"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679278370"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679278371"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278368"><span class="hs-identifier hs-var">fps</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>              </span><a name="local-6989586621679278357"><a href="#local-6989586621679278357"><span class="hs-identifier">s1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278356"><span class="hs-identifier hs-var">subts</span></a><span> </span><a href="#local-6989586621679278350"><span class="hs-identifier hs-var">finalpats</span></a><span> </span><a href="#local-6989586621679278351"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-121"></a><span>              </span><span class="hs-comment">--s2 = subts pats2 bod2</span><span>
</span><a name="line-122"></a><span>              </span><a name="local-6989586621679278358"><a href="#local-6989586621679278358"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278354"><span class="hs-identifier hs-var">template</span></a><span> </span><a href="#local-6989586621679278350"><span class="hs-identifier hs-var">finalpats</span></a><span> </span><a href="#local-6989586621679278351"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-123"></a><span>              </span><span class="hs-comment">--t2 = template pats2 bod2</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">lambdaDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><a name="setSpanInfoEnd"><a href="Hint.Lambda.html#setSpanInfoEnd"><span class="hs-identifier">setSpanInfoEnd</span></a></a><span> </span><a name="local-6989586621679278372"><a href="#local-6989586621679278372"><span class="hs-identifier">ssi</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679278373"><a href="#local-6989586621679278373"><span class="hs-identifier">line</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679278374"><a href="#local-6989586621679278374"><span class="hs-identifier">col</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278372"><span class="hs-identifier hs-var">ssi</span></a><span class="hs-special">{</span><span class="hs-identifier">srcInfoSpan</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">srcInfoSpan</span><span> </span><a href="#local-6989586621679278372"><span class="hs-identifier hs-var">ssi</span></a><span class="hs-special">)</span><span class="hs-special">{</span><span class="hs-identifier">srcSpanEndLine</span><span class="hs-glyph">=</span><a href="#local-6989586621679278373"><span class="hs-identifier hs-var">line</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">srcSpanEndColumn</span><span class="hs-glyph">=</span><a href="#local-6989586621679278374"><span class="hs-identifier hs-var">col</span></a><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-identifier">etaReduce</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><a name="etaReduce"><a href="Hint.Lambda.html#etaReduce"><span class="hs-identifier">etaReduce</span></a></a><span> </span><a name="local-6989586621679278375"><a href="#local-6989586621679278375"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278376"><a href="#local-6989586621679278376"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnQual</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278377"><a href="#local-6989586621679278377"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679278375"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278378"><a href="#local-6989586621679278378"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679278375"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278378"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679278377"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278378"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;mr&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278377"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><a href="HSE.All.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679278376"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="HSE.Util.html#isQuasiQuote"><span class="hs-identifier hs-var">isQuasiQuote</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679278376"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#etaReduce"><span class="hs-identifier hs-var">etaReduce</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679278375"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278376"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-135"></a><span class="hs-identifier">etaReduce</span><span> </span><a name="local-6989586621679278379"><a href="#local-6989586621679278379"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">InfixApp</span><span> </span><a name="local-6989586621679278380"><a href="#local-6989586621679278380"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679278381"><a href="#local-6989586621679278381"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="HSE.Util.html#isDol"><span class="hs-identifier hs-var">isDol</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679278382"><a href="#local-6989586621679278382"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#etaReduce"><span class="hs-identifier hs-var">etaReduce</span></a><span> </span><a href="#local-6989586621679278379"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><a href="#local-6989586621679278380"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679278381"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679278382"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span class="hs-identifier">etaReduce</span><span> </span><a name="local-6989586621679278383"><a href="#local-6989586621679278383"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679278384"><a href="#local-6989586621679278384"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278383"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">,</span><a href="#local-6989586621679278384"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">--Section refactoring is not currently implemented.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">lambdaExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><a name="lambdaExp"><a href="Hint.Lambda.html#lambdaExp"><span class="hs-identifier">lambdaExp</span></a></a><span> </span><a name="local-6989586621679278385"><a href="#local-6989586621679278385"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278386"><a href="#local-6989586621679278386"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Paren</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278387"><a href="#local-6989586621679278387"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><a name="local-6989586621679278388"><a href="#local-6989586621679278388"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnQual</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Symbol</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278389"><a href="#local-6989586621679278389"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679278390"><a href="#local-6989586621679278390"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isAtom</span><span> </span><a href="#local-6989586621679278390"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#isTypeApp"><span class="hs-identifier hs-var">isTypeApp</span></a><span> </span><a href="#local-6989586621679278390"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="HSE.Util.html#allowLeftSection"><span class="hs-identifier hs-var">allowLeftSection</span></a><span> </span><a href="#local-6989586621679278389"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-special">[</span><a href="Idea.html#suggestN"><span class="hs-identifier hs-var">suggestN</span></a><span> </span><span class="hs-string">&quot;Use section&quot;</span><span> </span><a href="#local-6989586621679278386"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278391"><span class="hs-identifier hs-var">exp</span></a><span> </span><a href="#local-6989586621679278390"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679278389"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- [Replace Expr (toSS o) subts template]]</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>      </span><a name="local-6989586621679278391"><a href="#local-6989586621679278391"><span class="hs-identifier">exp</span></a></a><span> </span><a name="local-6989586621679278392"><a href="#local-6989586621679278392"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679278393"><a href="#local-6989586621679278393"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LeftSection</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278392"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><a href="#local-6989586621679278393"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-comment">--      template = prettyPrint (exp (toNamed &quot;a&quot;) &quot;*&quot;)</span><span>
</span><a name="line-146"></a><span class="hs-comment">--      subts = [(&quot;a&quot;, toSS y), (&quot;*&quot;, toSS v)]</span><span>
</span><a name="line-147"></a><span class="hs-identifier">lambdaExp</span><span> </span><a name="local-6989586621679278394"><a href="#local-6989586621679278394"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278395"><a href="#local-6989586621679278395"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Paren</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#Var_"><span class="hs-identifier hs-var">Var_</span></a><span> </span><span class="hs-string">&quot;flip&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Var</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278396"><a href="#local-6989586621679278396"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679278397"><a href="#local-6989586621679278397"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="HSE.Util.html#allowRightSection"><span class="hs-identifier hs-var">allowRightSection</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679278396"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-special">[</span><a href="Idea.html#suggestN"><span class="hs-identifier hs-var">suggestN</span></a><span> </span><span class="hs-string">&quot;Use section&quot;</span><span> </span><a href="#local-6989586621679278395"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">RightSection</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">QVarOp</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278396"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278397"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span class="hs-identifier">lambdaExp</span><span> </span><a name="local-6989586621679278398"><a href="#local-6989586621679278398"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278399"><a href="#local-6989586621679278399"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">Lambda</span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HSE.Util.html#isInfixApp"><span class="hs-identifier hs-var">isInfixApp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278398"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679278402"><a href="#local-6989586621679278402"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679278403"><a href="#local-6989586621679278403"><span class="hs-identifier">refact</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hint.Util.html#niceLambdaR"><span class="hs-identifier hs-var">niceLambdaR</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679278399"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Util.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="HSE.Util.html#isQuasiQuote"><span class="hs-identifier hs-var">isQuasiQuote</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;runST&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Set.member</span><span class="hs-special">`</span><span> </span><a href="HSE.All.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a><span> </span><a href="#local-6989586621679278399"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679278404"><a href="#local-6989586621679278404"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Avoid lambda&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679278400"><span class="hs-identifier hs-var">countInfixNames</span></a><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679278400"><span class="hs-identifier hs-var">countInfixNames</span></a><span> </span><a href="#local-6989586621679278399"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot; using `infix`&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="HSE.Util.html#isVar"><span class="hs-identifier hs-var">isVar</span></a><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="HSE.Util.html#isCon"><span class="hs-identifier hs-var">isCon</span></a><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Idea.html#warn"><span class="hs-identifier hs-var">warn</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278404"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679278399"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679278402"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278403"><span class="hs-identifier hs-var">refact</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278399"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679278400"><a href="#local-6989586621679278400"><span class="hs-identifier">countInfixNames</span></a></a><span> </span><a name="local-6989586621679278401"><a href="#local-6989586621679278401"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">RightSection</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">QVarOp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">UnQual</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679278401"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span class="hs-identifier">lambdaExp</span><span> </span><a name="local-6989586621679278405"><a href="#local-6989586621679278405"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278406"><a href="#local-6989586621679278406"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lambda</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278407"><a href="#local-6989586621679278407"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-6989586621679278408"><a href="#local-6989586621679278408"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="HSE.Util.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a><span> </span><span class="hs-special">(</span><a href="HSE.Util.html#fromParen"><span class="hs-identifier hs-var">fromParen</span></a><span> </span><a href="#local-6989586621679278408"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679278409"><span class="hs-identifier hs-var">pats</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HSE.Util.html#isLambda"><span class="hs-identifier hs-var">isLambda</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278405"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Collapse lambdas&quot;</span><span> </span><a href="#local-6989586621679278406"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lambda</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278409"><span class="hs-identifier hs-var">pats</span></a><span> </span><a href="#local-6989586621679278410"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278406"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278413"><span class="hs-identifier hs-var">subts</span></a><span> </span><a href="#local-6989586621679278411"><span class="hs-identifier hs-var">template</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679278409"><a href="#local-6989586621679278409"><span class="hs-identifier">pats</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679278410"><a href="#local-6989586621679278410"><span class="hs-identifier">body</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.Lambda.html#fromLambda"><span class="hs-identifier hs-var">fromLambda</span></a><span> </span><a href="#local-6989586621679278406"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-159"></a><span>      </span><a name="local-6989586621679278411"><a href="#local-6989586621679278411"><span class="hs-identifier">template</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span>  </span><span class="hs-identifier hs-var">Lambda</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679278412"><span class="hs-identifier hs-var">munge</span></a><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679278409"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;body&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>      </span><span class="hs-identifier">munge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span>
</span><a name="line-161"></a><span>      </span><a name="local-6989586621679278412"><a href="#local-6989586621679278412"><span class="hs-identifier">munge</span></a></a><span> </span><a name="local-6989586621679278414"><a href="#local-6989586621679278414"><span class="hs-identifier">ident</span></a></a><span> </span><a name="local-6989586621679278415"><a href="#local-6989586621679278415"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">PWildCard</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278415"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-162"></a><span>      </span><span class="hs-identifier">munge</span><span> </span><a name="local-6989586621679278416"><a href="#local-6989586621679278416"><span class="hs-identifier">ident</span></a></a><span> </span><a name="local-6989586621679278417"><a href="#local-6989586621679278417"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679278417"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679278417"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679278416"><span class="hs-identifier hs-var">ident</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>      </span><a name="local-6989586621679278413"><a href="#local-6989586621679278413"><span class="hs-identifier">subts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;body&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278410"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679278418"><a href="#local-6989586621679278418"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679278419"><a href="#local-6989586621679278419"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679278418"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679278419"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679278409"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span class="hs-identifier">lambdaExp</span><span> </span><a name="local-6989586621679278420"><a href="#local-6989586621679278420"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278421"><a href="#local-6989586621679278421"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lambda</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#PVar_"><span class="hs-identifier hs-var">PVar_</span></a><span> </span><a name="local-6989586621679278422"><a href="#local-6989586621679278422"><span class="hs-identifier">u</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Case</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#Var_"><span class="hs-identifier hs-var">Var_</span></a><span> </span><a name="local-6989586621679278423"><a href="#local-6989586621679278423"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679278424"><a href="#local-6989586621679278424"><span class="hs-identifier">alts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679278422"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679278423"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278422"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><a href="HSE.All.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679278424"><span class="hs-identifier hs-var">alts</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Idea.html#suggestN"><span class="hs-identifier hs-var">suggestN</span></a><span> </span><span class="hs-string">&quot;Use lambda-case&quot;</span><span> </span><a href="#local-6989586621679278421"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">LCase</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278424"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">)</span><span class="hs-special">{</span><span class="hs-identifier">ideaNote</span><span class="hs-glyph">=</span><span class="hs-special">[</span><a href="Config.Type.html#RequiresExtension"><span class="hs-identifier hs-var">RequiresExtension</span></a><span> </span><span class="hs-string">&quot;LambdaCase&quot;</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span class="hs-identifier">lambdaExp</span><span> </span><a name="local-6989586621679278425"><a href="#local-6989586621679278425"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679278426"><a href="#local-6989586621679278426"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lambda</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#PVar_"><span class="hs-identifier hs-var">PVar_</span></a><span> </span><a name="local-6989586621679278427"><a href="#local-6989586621679278427"><span class="hs-identifier">u</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Tuple</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278428"><a href="#local-6989586621679278428"><span class="hs-identifier">boxed</span></a></a><span> </span><a name="local-6989586621679278429"><a href="#local-6989586621679278429"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a name="local-6989586621679278430"><a href="#local-6989586621679278430"><span class="hs-identifier">yes</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679278431"><a href="#local-6989586621679278431"><span class="hs-identifier">no</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">partition</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><a href="#local-6989586621679278427"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278429"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278427"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="HSE.All.html#vars"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679278431"><span class="hs-identifier hs-var">no</span></a><span>
</span><a name="line-168"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Idea.html#suggestN"><span class="hs-identifier hs-var">suggestN</span></a><span> </span><span class="hs-string">&quot;Use tuple-section&quot;</span><span> </span><a href="#local-6989586621679278426"><span class="hs-identifier hs-var">o</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TupleSection</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679278428"><span class="hs-identifier hs-var">boxed</span></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679278432"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><a href="#local-6989586621679278427"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679278432"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679278432"><a href="#local-6989586621679278432"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679278429"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>        </span><span class="hs-special">{</span><span class="hs-identifier">ideaNote</span><span class="hs-glyph">=</span><span class="hs-special">[</span><a href="Config.Type.html#RequiresExtension"><span class="hs-identifier hs-var">RequiresExtension</span></a><span> </span><span class="hs-string">&quot;TupleSections&quot;</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><span class="hs-identifier">lambdaExp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- replace any repeated pattern variable with _</span><span>
</span><a name="line-174"></a><span class="hs-identifier">fromLambda</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><a name="fromLambda"><a href="Hint.Lambda.html#fromLambda"><span class="hs-identifier">fromLambda</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Lambda</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679278433"><a href="#local-6989586621679278433"><span class="hs-identifier">ps1</span></a></a><span> </span><span class="hs-special">(</span><a href="Hint.Lambda.html#fromLambda"><span class="hs-identifier hs-var">fromLambda</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="HSE.Util.html#fromParen"><span class="hs-identifier hs-var">fromParen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679278434"><a href="#local-6989586621679278434"><span class="hs-identifier">ps2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679278435"><a href="#local-6989586621679278435"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">transformBi</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679278436"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.All.html#pvars"><span class="hs-identifier hs-var">pvars</span></a><span> </span><a href="#local-6989586621679278434"><span class="hs-identifier hs-var">ps2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679278433"><span class="hs-identifier hs-var">ps1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679278434"><span class="hs-identifier hs-var">ps2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278435"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679278436"><a href="#local-6989586621679278436"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679278437"><a href="#local-6989586621679278437"><span class="hs-identifier">bad</span></a></a><span> </span><a name="local-6989586621679278438"><a href="#local-6989586621679278438"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-identifier hs-var">PVar</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679278438"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679278437"><span class="hs-identifier hs-var">bad</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PWildCard</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span>
</span><a name="line-177"></a><span>          </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679278439"><a href="#local-6989586621679278439"><span class="hs-identifier">bad</span></a></a><span> </span><a name="local-6989586621679278440"><a href="#local-6989586621679278440"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679278440"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-178"></a><span class="hs-identifier">fromLambda</span><span> </span><a name="local-6989586621679278441"><a href="#local-6989586621679278441"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679278441"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a></pre></body></html>