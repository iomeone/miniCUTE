<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns, PatternGuards, FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-
    Find and match:

&lt;TEST&gt;
yes = 1:2:[] -- [1,2]
yes = ['h','e','l','l','o']
yes (1:2:[]) = 1 -- [1,2]
yes ['h','e'] = 1

-- [a]++b -&gt; a : b, but only if not in a chain of ++'s
yes = [x] ++ xs -- x : xs
no = &quot;x&quot; ++ xs
no = [x] ++ xs ++ ys
no = xs ++ [x] ++ ys
yes = [if a then b else c] ++ xs -- (if a then b else c) : xs
yes = [1] : [2] : [3] : [4] : [5] : [] -- [[1], [2], [3], [4], [5]]
yes = if x == e then l2 ++ xs else [x] ++ check_elem xs -- x : check_elem xs
data Yes = Yes (Maybe [Char]) -- Maybe String
yes = y :: [Char] -&gt; a -- String -&gt; a
instance C [Char]
foo = [a b] ++ xs -- a b : xs
foo = [myexpr | True, a] -- [myexpr | a]
foo = [myexpr | False] -- []
foo = map f [x + 1 | x &lt;- [1..10]] -- [f (x + 1) | x &lt;- [1..10]]
foo = [x + 1 | x &lt;- [1..10], feature] -- [x + 1 | feature, x &lt;- [1..10]]
foo = [x + 1 | x &lt;- [1..10], even x]
foo = [x + 1 | x &lt;- [1..10], even x, dont_reoder_guards]
foo = [x + 1 | x &lt;- [1..10], let y = even x, y]
foo = [x + 1 | x &lt;- [1..10], let q = even 1, q] -- [x + 1 | let q = even 1, q, x &lt;- [1..10]]
foo = [fooValue | Foo{..} &lt;- y, fooField]
issue619 = [pkgJobs | Pkg{pkgGpd, pkgJobs} &lt;- pkgs, not $ null $ C.condTestSuites pkgGpd]
&lt;/TEST&gt;
-}</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hint.List</span><span class="hs-special">(</span><a href="Hint.List.html#listHint"><span class="hs-identifier hs-var">listHint</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Hint.Type.html"><span class="hs-identifier">Hint.Type</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List.Extra</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">SrcSpan</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Refact.Types</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">R</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">listHint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hint.Type.html#DeclHint"><span class="hs-identifier hs-type">DeclHint</span></a><span>
</span><a name="line-49"></a><a name="listHint"><a href="Hint.List.html#listHint"><span class="hs-identifier">listHint</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.List.html#listDecl"><span class="hs-identifier hs-var">listDecl</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-identifier">listDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-52"></a><a name="listDecl"><a href="Hint.List.html#listDecl"><span class="hs-identifier">listDecl</span></a></a><span> </span><a name="local-6989586621679276671"><a href="#local-6989586621679276671"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Hint.List.html#listExp"><span class="hs-identifier hs-var">listExp</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">childrenBi</span><span> </span><a href="#local-6989586621679276671"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-54"></a><span>    </span><a href="Hint.List.html#stringType"><span class="hs-identifier hs-var">stringType</span></a><span> </span><a href="#local-6989586621679276671"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.List.html#listPat"><span class="hs-identifier hs-var">listPat</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">childrenBi</span><span> </span><a href="#local-6989586621679276671"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.List.html#listComp"><span class="hs-identifier hs-var">listComp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">universeBi</span><span> </span><a href="#local-6989586621679276671"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">listComp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-59"></a><a name="listComp"><a href="Hint.List.html#listComp"><span class="hs-identifier">listComp</span></a></a><span> </span><a name="local-6989586621679276672"><a href="#local-6989586621679276672"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListComp</span><span> </span><a name="local-6989586621679276673"><a href="#local-6989586621679276673"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679276674"><a href="#local-6989586621679276674"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679276675"><a href="#local-6989586621679276675"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;False&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679276680"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Short-circuited list comprehension&quot;</span><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276677"><span class="hs-identifier hs-var">o'</span></a><span> </span><span class="hs-special">(</span><a href="Hint.List.html#suggestExpr"><span class="hs-identifier hs-var">suggestExpr</span></a><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276677"><span class="hs-identifier hs-var">o'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;True&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679276680"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Redundant True guards&quot;</span><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276678"><span class="hs-identifier hs-var">o2</span></a><span> </span><span class="hs-special">(</span><a href="Hint.List.html#suggestExpr"><span class="hs-identifier hs-var">suggestExpr</span></a><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276678"><span class="hs-identifier hs-var">o2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276675"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679276676"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Move guards forward&quot;</span><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276679"><span class="hs-identifier hs-var">o3</span></a><span> </span><span class="hs-special">(</span><a href="Hint.List.html#suggestExpr"><span class="hs-identifier hs-var">suggestExpr</span></a><span> </span><a href="#local-6989586621679276672"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276679"><span class="hs-identifier hs-var">o3</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-64"></a><span>        </span><a name="local-6989586621679276676"><a href="#local-6989586621679276676"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hint.List.html#moveGuardsForward"><span class="hs-identifier hs-var">moveGuardsForward</span></a><span> </span><a href="#local-6989586621679276675"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-65"></a><span>        </span><a name="local-6989586621679276677"><a href="#local-6989586621679276677"><span class="hs-identifier">o'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">List</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>        </span><a name="local-6989586621679276678"><a href="#local-6989586621679276678"><span class="hs-identifier">o2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ListComp</span><span> </span><a href="#local-6989586621679276673"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679276674"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-string">&quot;True&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679276681"><span class="hs-identifier hs-var">qualCon</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276675"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-67"></a><span>        </span><a name="local-6989586621679276679"><a href="#local-6989586621679276679"><span class="hs-identifier">o3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ListComp</span><span> </span><a href="#local-6989586621679276673"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679276674"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679276676"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-68"></a><span>        </span><a name="local-6989586621679276680"><a href="#local-6989586621679276680"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="#local-6989586621679276681"><span class="hs-identifier hs-var">qualCon</span></a><span> </span><a href="#local-6989586621679276675"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-69"></a><span>        </span><a name="local-6989586621679276681"><a href="#local-6989586621679276681"><span class="hs-identifier">qualCon</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">QualStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Qualifier</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Con</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276682"><a href="#local-6989586621679276682"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Match.html#fromNamed"><span class="hs-identifier hs-var">fromNamed</span></a><span> </span><a href="#local-6989586621679276682"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-70"></a><span>        </span><span class="hs-identifier">qualCon</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-71"></a><span class="hs-identifier">listComp</span><span> </span><a name="local-6989586621679276683"><a href="#local-6989586621679276683"><span class="hs-identifier">o</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#App2"><span class="hs-identifier hs-var">App2</span></a><span> </span><a name="local-6989586621679276684"><a href="#local-6989586621679276684"><span class="hs-identifier">mp</span></a></a><span> </span><a name="local-6989586621679276685"><a href="#local-6989586621679276685"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ListComp</span><span> </span><a name="local-6989586621679276686"><a href="#local-6989586621679276686"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679276687"><a href="#local-6989586621679276687"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679276688"><a href="#local-6989586621679276688"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276684"><span class="hs-identifier hs-var">mp</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;map&quot;</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Move map inside list comprehension&quot;</span><span> </span><a href="#local-6989586621679276683"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276689"><span class="hs-identifier hs-var">o2</span></a><span> </span><span class="hs-special">(</span><a href="Hint.List.html#suggestExpr"><span class="hs-identifier hs-var">suggestExpr</span></a><span> </span><a href="#local-6989586621679276683"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679276689"><span class="hs-identifier hs-var">o2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679276689"><a href="#local-6989586621679276689"><span class="hs-identifier">o2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ListComp</span><span> </span><a href="#local-6989586621679276686"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">App</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">paren</span><span> </span><a href="#local-6989586621679276685"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">paren</span><span> </span><a href="#local-6989586621679276687"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276688"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-74"></a><span class="hs-identifier">listComp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-identifier">suggestExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Refactoring</span><span> </span><span class="hs-identifier hs-type">R.SrcSpan</span><span class="hs-special">]</span><span>
</span><a name="line-77"></a><a name="suggestExpr"><a href="Hint.List.html#suggestExpr"><span class="hs-identifier">suggestExpr</span></a></a><span> </span><a name="local-6989586621679276690"><a href="#local-6989586621679276690"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679276691"><a href="#local-6989586621679276691"><span class="hs-identifier">o2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276690"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679276691"><span class="hs-identifier hs-var">o2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- Move all the list comp guards as far forward as they can go</span><span>
</span><a name="line-80"></a><span class="hs-identifier">moveGuardsForward</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">QualStmt</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">QualStmt</span><span> </span><a href="HSE.Type.html#S"><span class="hs-identifier hs-type">S</span></a><span class="hs-special">]</span><span>
</span><a name="line-81"></a><a name="moveGuardsForward"><a href="Hint.List.html#moveGuardsForward"><span class="hs-identifier">moveGuardsForward</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679276692"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>        </span><a name="local-6989586621679276692"><a href="#local-6989586621679276692"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679276694"><a href="#local-6989586621679276694"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679276695"><a href="#local-6989586621679276695"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">QualStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Generator</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276696"><a href="#local-6989586621679276696"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679276697"><a href="#local-6989586621679276697"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679276699"><span class="hs-identifier hs-var">stop</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679276695"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679276692"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276698"><span class="hs-identifier hs-var">move</span></a><span> </span><a href="#local-6989586621679276697"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-84"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276698"><a href="#local-6989586621679276698"><span class="hs-identifier">move</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276699"><a href="#local-6989586621679276699"><span class="hs-identifier">stop</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">span</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><a href="HSE.Util.html#isPFieldWildcard"><span class="hs-identifier hs-var">isPFieldWildcard</span></a><span> </span><span class="hs-special">(</span><a href="HSE.Util.html#universeS"><span class="hs-identifier hs-var">universeS</span></a><span> </span><a href="#local-6989586621679276695"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679276700"><a href="#local-6989586621679276700"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.All.html#pvars"><span class="hs-identifier hs-var">pvars</span></a><span> </span><a href="#local-6989586621679276696"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">disjoint</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679276693"><span class="hs-identifier hs-var">vars'</span></a><span> </span><a href="#local-6989586621679276700"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276694"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-85"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276701"><a href="#local-6989586621679276701"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679276702"><a href="#local-6989586621679276702"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">QualStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">Qualifier</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679276703"><a href="#local-6989586621679276703"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679276692"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276702"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679276701"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276703"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-86"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276704"><a href="#local-6989586621679276704"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679276705"><a href="#local-6989586621679276705"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">QualStmt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier hs-var">LetStmt</span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679276706"><a href="#local-6989586621679276706"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679276692"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276705"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679276704"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276706"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-87"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276707"><a href="#local-6989586621679276707"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621679276708"><a href="#local-6989586621679276708"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679276707"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679276708"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>        </span><span class="hs-comment">-- the type QualStmt doesn't have a Var instance, so fake something that works</span><span>
</span><a name="line-90"></a><span>        </span><a name="local-6989586621679276693"><a href="#local-6989586621679276693"><span class="hs-identifier">vars'</span></a></a><span> </span><a name="local-6989586621679276709"><a href="#local-6989586621679276709"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679276710"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Var</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276710"><a href="#local-6989586621679276710"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HSE.Util.html#universeS"><span class="hs-identifier hs-var">universeS</span></a><span> </span><a href="#local-6989586621679276709"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- boolean = are you in a ++ chain</span><span>
</span><a name="line-94"></a><span class="hs-identifier">listExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><a name="listExp"><a href="Hint.List.html#listExp"><span class="hs-identifier">listExp</span></a></a><span> </span><a name="local-6989586621679276711"><a href="#local-6989586621679276711"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="HSE.Util.html#fromParen"><span class="hs-identifier hs-var">fromParen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679276712"><a href="#local-6989586621679276712"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-96"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679276713"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Hint.List.html#listExp"><span class="hs-identifier hs-var">listExp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Hint.List.html#isAppend"><span class="hs-identifier hs-var">isAppend</span></a><span> </span><a href="#local-6989586621679276712"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">children</span><span> </span><a href="#local-6989586621679276712"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679276713"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-98"></a><span>        </span><a name="local-6989586621679276713"><a href="#local-6989586621679276713"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679276714"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679276712"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679276716"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276719"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276714"><a href="#local-6989586621679276714"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><a name="local-6989586621679276715"><a href="#local-6989586621679276715"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hint.List.html#checks"><span class="hs-identifier hs-var">checks</span></a><span>
</span><a name="line-99"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276716"><a href="#local-6989586621679276716"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276717"><a href="#local-6989586621679276717"><span class="hs-identifier">subts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276718"><a href="#local-6989586621679276718"><span class="hs-identifier">temp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276715"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276711"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679276712"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span>                                  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679276719"><a href="#local-6989586621679276719"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Expr</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276712"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276717"><span class="hs-identifier hs-var">subts</span></a><span> </span><a href="#local-6989586621679276718"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">listPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-103"></a><a name="listPat"><a href="Hint.List.html#listPat"><span class="hs-identifier">listPat</span></a></a><span> </span><a name="local-6989586621679276720"><a href="#local-6989586621679276720"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679276721"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Hint.List.html#listPat"><span class="hs-identifier hs-var">listPat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">children</span><span> </span><a href="#local-6989586621679276720"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679276721"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679276721"><a href="#local-6989586621679276721"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><a href="#local-6989586621679276722"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679276720"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679276724"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276727"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-105"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276722"><a href="#local-6989586621679276722"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><a name="local-6989586621679276723"><a href="#local-6989586621679276723"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hint.List.html#pchecks"><span class="hs-identifier hs-var">pchecks</span></a><span>
</span><a name="line-106"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276724"><a href="#local-6989586621679276724"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276725"><a href="#local-6989586621679276725"><span class="hs-identifier">subts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276726"><a href="#local-6989586621679276726"><span class="hs-identifier">temp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276723"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276720"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679276727"><a href="#local-6989586621679276727"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Pattern</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276720"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276725"><span class="hs-identifier hs-var">subts</span></a><span> </span><a href="#local-6989586621679276726"><span class="hs-identifier hs-var">temp</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><a name="isAppend"><a href="Hint.List.html#isAppend"><span class="hs-identifier">isAppend</span></a></a><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#App2"><span class="hs-identifier hs-var">App2</span></a><span> </span><a name="local-6989586621679276728"><a href="#local-6989586621679276728"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679276728"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;++&quot;</span><span>
</span><a name="line-110"></a><span class="hs-identifier">isAppend</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><a name="checks"><a href="Hint.List.html#checks"><span class="hs-identifier">checks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276729"><a href="#local-6989586621679276729"><span class="hs-operator">*</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- see #174</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">[</span><span class="hs-string">&quot;Use string literal&quot;</span><span> </span><a href="#local-6989586621679276729"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Hint.List.html#useString"><span class="hs-identifier hs-var">useString</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">,</span><span class="hs-string">&quot;Use list literal&quot;</span><span> </span><a href="#local-6989586621679276729"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Hint.List.html#useList"><span class="hs-identifier hs-var">useList</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-special">,</span><span class="hs-string">&quot;Use :&quot;</span><span> </span><a href="#local-6989586621679276729"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Hint.List.html#useCons"><span class="hs-identifier hs-var">useCons</span></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><a name="pchecks"><a href="Hint.List.html#pchecks"><span class="hs-identifier">pchecks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276730"><a href="#local-6989586621679276730"><span class="hs-operator">*</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- see #174</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">[</span><span class="hs-string">&quot;Use string literal pattern&quot;</span><span> </span><a href="#local-6989586621679276730"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Hint.List.html#usePString"><span class="hs-identifier hs-var">usePString</span></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-special">,</span><span class="hs-string">&quot;Use list literal pattern&quot;</span><span> </span><a href="#local-6989586621679276730"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Hint.List.html#usePList"><span class="hs-identifier hs-var">usePList</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><a name="usePString"><a href="Hint.List.html#usePString"><span class="hs-identifier">usePString</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PList</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276731"><a href="#local-6989586621679276731"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276731"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679276732"><a href="#local-6989586621679276732"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="HSE.Util.html#fromPChar"><span class="hs-identifier hs-var">fromPChar</span></a><span> </span><a href="#local-6989586621679276731"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679276733"><a href="#local-6989586621679276733"><span class="hs-identifier">literal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">PLit</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Signless</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">String</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679276732"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679276732"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276733"><span class="hs-identifier hs-var">literal</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679276733"><span class="hs-identifier hs-var">literal</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-identifier">usePString</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><a name="usePList"><a href="Hint.List.html#usePList"><span class="hs-identifier">usePList</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>        </span><span class="hs-identifier hs-var">fmap</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679276746"><a href="#local-6989586621679276746"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276747"><a href="#local-6989586621679276747"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PList</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679276746"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276747"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PList</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679276747"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unzip</span><span>
</span><a name="line-133"></a><span>              </span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679276734"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>        </span><a name="local-6989586621679276734"><a href="#local-6989586621679276734"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679276736"><a href="#local-6989586621679276736"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276737"><a href="#local-6989586621679276737"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276737"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;[]&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679276736"><span class="hs-identifier hs-var">first</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-137"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276738"><a href="#local-6989586621679276738"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679276739"><a href="#local-6989586621679276739"><span class="hs-identifier">ident</span></a></a><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679276740"><a href="#local-6989586621679276740"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#PApp_"><span class="hs-identifier hs-var">PApp_</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679276741"><a href="#local-6989586621679276741"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679276742"><a href="#local-6989586621679276742"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-138"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679276741"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679276735"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679276739"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679276741"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679276734"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679276740"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679276742"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-139"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276743"><a href="#local-6989586621679276743"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="HSE.Type.html#Pat_"><span class="hs-identifier hs-type">Pat_</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>        </span><a name="local-6989586621679276735"><a href="#local-6989586621679276735"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679276744"><a href="#local-6989586621679276744"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679276745"><a href="#local-6989586621679276745"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679276744"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">PVar</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ann</span><span> </span><a href="#local-6989586621679276745"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276744"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><a name="useString"><a href="Hint.List.html#useString"><span class="hs-identifier">useString</span></a></a><span> </span><a name="local-6989586621679276748"><a href="#local-6989586621679276748"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">List</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276749"><a href="#local-6989586621679276749"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276749"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679276750"><a href="#local-6989586621679276750"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="HSE.Util.html#fromChar"><span class="hs-identifier hs-var">fromChar</span></a><span> </span><a href="#local-6989586621679276749"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679276751"><a href="#local-6989586621679276751"><span class="hs-identifier">literal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Lit</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">String</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679276750"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679276750"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276751"><span class="hs-identifier hs-var">literal</span></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="#local-6989586621679276751"><span class="hs-identifier hs-var">literal</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-identifier">useString</span><span> </span><a name="local-6989586621679276752"><a href="#local-6989586621679276752"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><a name="useList"><a href="Hint.List.html#useList"><span class="hs-identifier">useList</span></a></a><span> </span><a name="local-6989586621679276753"><a href="#local-6989586621679276753"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-identifier hs-var">fmap</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679276767"><a href="#local-6989586621679276767"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276768"><a href="#local-6989586621679276768"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">List</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679276767"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276768"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">List</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679276768"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unzip</span><span>
</span><a name="line-152"></a><span>              </span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679276754"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-155"></a><span>        </span><a name="local-6989586621679276754"><a href="#local-6989586621679276754"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679276756"><a href="#local-6989586621679276756"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276757"><a href="#local-6989586621679276757"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276757"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;[]&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679276756"><span class="hs-identifier hs-var">first</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-156"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276758"><a href="#local-6989586621679276758"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679276759"><a href="#local-6989586621679276759"><span class="hs-identifier">ident</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679276760"><a href="#local-6989586621679276760"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#App2"><span class="hs-identifier hs-var">App2</span></a><span> </span><a name="local-6989586621679276761"><a href="#local-6989586621679276761"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679276762"><a href="#local-6989586621679276762"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679276763"><a href="#local-6989586621679276763"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276761"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-157"></a><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679276762"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679276755"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679276759"><span class="hs-identifier hs-var">ident</span></a><span> </span><a href="#local-6989586621679276762"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679276754"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679276760"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679276763"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-158"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679276764"><a href="#local-6989586621679276764"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="HSE.Type.html#Exp_"><span class="hs-identifier hs-type">Exp_</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>        </span><a name="local-6989586621679276755"><a href="#local-6989586621679276755"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679276765"><a href="#local-6989586621679276765"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679276766"><a href="#local-6989586621679276766"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679276765"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679276765"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><a name="useCons"><a href="Hint.List.html#useCons"><span class="hs-identifier">useCons</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HSE.Match.html#App2"><span class="hs-identifier hs-var">App2</span></a><span> </span><a name="local-6989586621679276769"><a href="#local-6989586621679276769"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679276770"><a href="#local-6989586621679276770"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679276771"><a href="#local-6989586621679276771"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679276769"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="HSE.Match.html#~%3D"><span class="hs-operator hs-var">~=</span></a><span> </span><span class="hs-string">&quot;++&quot;</span><span>
</span><a name="line-164"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679276777"><a href="#local-6989586621679276777"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679276778"><a href="#local-6989586621679276778"><span class="hs-identifier">build</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679276772"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276770"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-165"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Hint.List.html#isAppend"><span class="hs-identifier hs-var">isAppend</span></a><span> </span><a href="#local-6989586621679276771"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276773"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276778"><span class="hs-identifier hs-var">build</span></a><span> </span><a href="#local-6989586621679276777"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679276771"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-167"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276777"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;xs&quot;</span><span class="hs-special">,</span><span> </span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276771"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679276773"><span class="hs-identifier hs-var">gen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276778"><span class="hs-identifier hs-var">build</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;xs&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>        </span><a name="local-6989586621679276772"><a href="#local-6989586621679276772"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">List</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679276774"><a href="#local-6989586621679276774"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679276774"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679276775"><a href="#local-6989586621679276775"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="HSE.Util.html#isApp"><span class="hs-identifier hs-var">isApp</span></a><span> </span><a href="#local-6989586621679276774"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679276775"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">paren</span><span> </span><a href="#local-6989586621679276775"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span>        </span><a name="local-6989586621679276773"><a href="#local-6989586621679276773"><span class="hs-identifier">gen</span></a></a><span> </span><a name="local-6989586621679276776"><a href="#local-6989586621679276776"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">InfixApp</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><a href="#local-6989586621679276776"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">QConOp</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">list_cons_name</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span class="hs-identifier">useCons</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><a name="typeListChar"><a href="Hint.List.html#typeListChar"><span class="hs-identifier">typeListChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TyList</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TyCon</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;Char&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><a name="typeString"><a href="Hint.List.html#typeString"><span class="hs-identifier">typeString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TyCon</span><span> </span><a href="HSE.Util.html#an"><span class="hs-identifier hs-var">an</span></a><span> </span><span class="hs-special">(</span><a href="HSE.Match.html#toNamed"><span class="hs-identifier hs-var">toNamed</span></a><span> </span><span class="hs-string">&quot;String&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">stringType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Decl_"><span class="hs-identifier hs-type">Decl_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-184"></a><a name="stringType"><a href="Hint.List.html#stringType"><span class="hs-identifier">stringType</span></a></a><span> </span><a name="local-6989586621679276779"><a href="#local-6989586621679276779"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679276779"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-identifier hs-var">InstDecl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679276789"><a href="#local-6989586621679276789"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679276780"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276789"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-186"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679276780"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276779"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-187"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-188"></a><span>        </span><a name="local-6989586621679276780"><a href="#local-6989586621679276780"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679276782"><a href="#local-6989586621679276782"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679276781"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">childrenBi</span><span> </span><a href="#local-6989586621679276782"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HSE.Type.html#Type_"><span class="hs-identifier hs-type">Type_</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Idea.html#Idea"><span class="hs-identifier hs-type">Idea</span></a><span class="hs-special">]</span><span>
</span><a name="line-191"></a><span>        </span><a name="local-6989586621679276781"><a href="#local-6989586621679276781"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679276783"><a href="#local-6989586621679276783"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HSE.Util.html#fromTyParen"><span class="hs-identifier hs-var">fromTyParen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679276784"><a href="#local-6989586621679276784"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Idea.html#suggest"><span class="hs-identifier hs-var">suggest</span></a><span> </span><span class="hs-string">&quot;Use String&quot;</span><span> </span><a href="#local-6989586621679276784"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">transform</span><span> </span><a href="#local-6989586621679276785"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679276784"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>                                    </span><a href="#local-6989586621679276786"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679276786"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">]</span><span>
</span><a name="line-193"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679276785"><a href="#local-6989586621679276785"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679276787"><a href="#local-6989586621679276787"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679276787"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">=~=</span><span> </span><a href="Hint.List.html#typeListChar"><span class="hs-identifier hs-var">typeListChar</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Hint.List.html#typeString"><span class="hs-identifier hs-var">typeString</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679276787"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-194"></a><span>                  </span><a name="local-6989586621679276786"><a href="#local-6989586621679276786"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Replace</span><span> </span><span class="hs-identifier hs-var">Type</span><span> </span><span class="hs-special">(</span><a href="Refact.html#toSS"><span class="hs-identifier hs-var">toSS</span></a><span> </span><a href="#local-6989586621679276788"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prettyPrint</span><span> </span><a href="Hint.List.html#typeString"><span class="hs-identifier hs-var">typeString</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679276788"><a href="#local-6989586621679276788"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">universe</span><span> </span><a href="#local-6989586621679276784"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679276788"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">=~=</span><span> </span><a href="Hint.List.html#typeListChar"><span class="hs-identifier hs-var">typeListChar</span></a><span class="hs-special">]</span><span>
</span><a name="line-195"></a></pre></body></html>