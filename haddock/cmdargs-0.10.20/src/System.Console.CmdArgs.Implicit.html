<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards, PatternGuards #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
    This module provides simple command line argument processing.
    The main function of interest is 'cmdArgs'.
    A simple example is:

    @data Sample = Sample {hello :: String} deriving (Show, Data, Typeable)@

@
sample = Sample{hello = 'def' '&amp;=' 'help' \&quot;World argument\&quot; '&amp;=' 'opt' \&quot;world\&quot;}
         '&amp;=' 'summary' \&quot;Sample v1\&quot;
@

    @main = print =&lt;&lt; 'cmdArgs' sample@

    Attributes are used to control a number of behaviours:
    
    * The help message: 'help', 'typ', 'details', 'summary', 'program', 'groupname'
    
    * Flag behaviour: 'opt', 'enum', 'verbosity', 'ignore'
    
    * Flag name assignment: 'name', 'explicit'
    
    * Controlling non-flag arguments: 'args', 'argPos'

    * multi-mode programs: 'modes', 'auto'

    /Supported Types/: Each field in the record must be one of the supported
    atomic types (@String@, @Int@, @Integer@, @Float@, @Double@, @Bool@, an
    enumeration, a tuple of atomic types) or a list (@[]@) or @Maybe@ wrapping
    at atomic type.

    /Missing Fields/: If a field is shared by multiple modes, it may be omitted
    in subsequent modes, and will default to the previous value.

    /Purity/: Values created with annotations are not pure - the first
    time they are computed they will include the annotations, but subsequently
    they will not. If you wish to run the above example in a more robust way:

    @sample = 'cmdArgsMode' $ Sample{hello = ... -- as before@

    @main = print =&lt;&lt; 'cmdArgsRun' sample@

    Even using this scheme, sometimes GHC's optimisations may share values who
    have the same annotation. To disable sharing you may need to specify
    @\{\-\# OPTIONS_GHC -fno-cse \#\-\}@ in the module you define the flags.

    /Pure annotations/: Alternatively, you may use pure annotations, which are
    referentially transparent, but less type safe and more verbose. The initial
    example may be written as:

    @sample = 'record' Sample{} [hello := 'def' '+=' 'help' \&quot;World argument\&quot; '+=' 'opt' \&quot;world\&quot;]@
    @         '+=' 'summary' \&quot;Sample v1\&quot;@

    @main = print =&lt;&lt; (cmdArgs_ sample :: IO Sample)@

    All the examples are written using impure annotations. To convert to pure
    annotations follow the rules:
    
    &gt; Ctor {field1 = value1 &amp;= ann1, field2 = value2} &amp;= ann2 ==&gt; record Ctor{} [field1 := value1 += ann1, field2 := value2] += ann2
    &gt; Ctor (value1 &amp;= ann1) value2 &amp;= ann2 ==&gt; record Ctor{} [atom value1 += ann1, atom value2] += ann2
    &gt; modes [Ctor1{...}, Ctor2{...}] ==&gt; modes_ [record Ctor1{} [...], record Ctor2{} [...]]
    &gt; Ctor {field1 = enum [X &amp;= ann, Y]} ==&gt; record Ctor{} [enum_ field1 [atom X += ann, atom Y]]

    If you are willing to use TemplateHaskell, you can write in the impure syntax,
    but have your code automatically translated to the pure style. For more details see
    &quot;System.Console.CmdArgs.Quote&quot;.

-}</span><span>
</span><a name="line-70"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Console.CmdArgs.Implicit</span><span class="hs-special">(</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- * Running command lines</span><span>
</span><a name="line-72"></a><span>    </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgs"><span class="hs-identifier hs-var">cmdArgs</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode"><span class="hs-identifier hs-var">cmdArgsMode</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsRun"><span class="hs-identifier hs-var">cmdArgsRun</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgs_"><span class="hs-identifier hs-var">cmdArgs_</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode_"><span class="hs-identifier hs-var">cmdArgsMode_</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsApply"><span class="hs-identifier hs-var">cmdArgsApply</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- cmdArgsReform,</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-comment">-- * Constructing command lines</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-comment">-- | Attributes can work on a flag (inside a field), on a mode (outside the record),</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-comment">--   or on all modes (outside the 'modes' call).</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.CmdArgs.Implicit.UI.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.UI</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-comment">-- ** Impure</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.html#%26%3D"><span class="hs-operator hs-var">&amp;=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#modes"><span class="hs-identifier hs-var">modes</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#enum"><span class="hs-identifier hs-var">enum</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-comment">-- ** Pure</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%2B%3D"><span class="hs-operator hs-var">+=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#record"><span class="hs-identifier hs-var">record</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#atom"><span class="hs-identifier hs-var">atom</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span class="hs-special">(</span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#enum_"><span class="hs-identifier hs-var">enum_</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#modes_"><span class="hs-identifier hs-var">modes_</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-comment">-- * Re-exported for convenience</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-comment">-- | Provides a few opaque types (for writing type signatures),</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-comment">--   verbosity control, default values with 'def' and the</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-comment">--   @Data@/@Typeable@ type classes.</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.CmdArgs.Verbosity.html"><span class="hs-identifier">System.Console.CmdArgs.Verbosity</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.CmdArgs.Default.html"><span class="hs-identifier">System.Console.CmdArgs.Default</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>    </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Generics.Any.html"><span class="hs-identifier">Data.Generics.Any</span></a><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Exit</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Explicit.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit</span></a><span class="hs-special">(</span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span class="hs-special">,</span><a href="System.Console.CmdArgs.Explicit.html#processArgs"><span class="hs-identifier hs-var">processArgs</span></a><span class="hs-special">,</span><a href="System.Console.CmdArgs.Explicit.Type.html#remap"><span class="hs-identifier hs-var">remap</span></a><span class="hs-special">,</span><a href="System.Console.CmdArgs.Explicit.Type.html#modeReform"><span class="hs-identifier hs-var">modeReform</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.Ann</span></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Annotate.html"><span class="hs-identifier">System.Console.CmdArgs.Annotate</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%26%3D"><span class="hs-operator hs-var">&amp;=</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="System.Console.CmdArgs.Annotate.html"><span class="hs-identifier">System.Console.CmdArgs.Annotate</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%26%3D"><span class="hs-operator hs-var">&amp;=</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Implicit.Type.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.Type</span></a><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Implicit.Local.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.Local</span></a><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Implicit.Global.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.Global</span></a><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Implicit.UI.html"><span class="hs-identifier">System.Console.CmdArgs.Implicit.UI</span></a><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Verbosity.html"><span class="hs-identifier">System.Console.CmdArgs.Verbosity</span></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.CmdArgs.Default.html"><span class="hs-identifier">System.Console.CmdArgs.Default</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Take impurely annotated records and run the corresponding command line.</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   Shortcut for @'cmdArgsRun' . 'cmdArgsMode'@.</span><span>
</span><a name="line-109"></a><span class="hs-comment">--</span><span>
</span><a name="line-110"></a><span class="hs-comment">--   To use 'cmdArgs' with custom command line arguments see</span><span>
</span><a name="line-111"></a><span class="hs-comment">--   'System.Environment.withArgs'.</span><span>
</span><a name="line-112"></a><span class="hs-identifier">cmdArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254268"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679254268"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679254268"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-113"></a><a name="cmdArgs"><a href="System.Console.CmdArgs.Implicit.html#cmdArgs"><span class="hs-identifier">cmdArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsRun"><span class="hs-identifier hs-var">cmdArgsRun</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode"><span class="hs-identifier hs-var">cmdArgsMode</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Take purely annotated records and run the corresponding command line.</span><span>
</span><a name="line-117"></a><span class="hs-comment">--   Shortcut for @'cmdArgsRun' . 'cmdArgsMode_'@.</span><span>
</span><a name="line-118"></a><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span class="hs-comment">--   To use 'cmdArgs_' with custom command line arguments see</span><span>
</span><a name="line-120"></a><span class="hs-comment">--   'System.Environment.withArgs'.</span><span>
</span><a name="line-121"></a><span class="hs-identifier">cmdArgs_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254267"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679254267"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-122"></a><a name="cmdArgs_"><a href="System.Console.CmdArgs.Implicit.html#cmdArgs_"><span class="hs-identifier">cmdArgs_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsRun"><span class="hs-identifier hs-var">cmdArgsRun</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode_"><span class="hs-identifier hs-var">cmdArgsMode_</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">cmdArgsCapture</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254266"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Capture"><span class="hs-identifier hs-type">Capture</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254266"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><a name="cmdArgsCapture"><a href="System.Console.CmdArgs.Implicit.html#cmdArgsCapture"><span class="hs-identifier">cmdArgsCapture</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#remap"><span class="hs-identifier hs-var">remap</span></a><span> </span><a href="#local-6989586621679254269"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="#local-6989586621679254270"><span class="hs-identifier hs-var">proj</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Implicit.Global.html#global"><span class="hs-identifier hs-var">global</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Implicit.Local.html#local"><span class="hs-identifier hs-var">local</span></a><span>
</span><a name="line-127"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679254269"><a href="#local-6989586621679254269"><span class="hs-identifier">embed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Data.Generics.Any.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a><span>
</span><a name="line-128"></a><span>          </span><a name="local-6989586621679254270"><a href="#local-6989586621679254270"><span class="hs-identifier">proj</span></a></a><span> </span><a name="local-6989586621679254271"><a href="#local-6989586621679254271"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Data.Generics.Any.html#Any"><span class="hs-identifier hs-var">Any</span></a><span> </span><a href="#local-6989586621679254271"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679254269"><span class="hs-identifier hs-var">embed</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Take impurely annotated records and turn them in to a 'Mode' value, that can</span><span>
</span><a name="line-132"></a><span class="hs-comment">--   make use of the &quot;System.Console.CmdArgs.Explicit&quot; functions (i.e. 'process').</span><span>
</span><a name="line-133"></a><span class="hs-comment">--</span><span>
</span><a name="line-134"></a><span class="hs-comment">--   Annotated records are impure, and will only contain annotations on</span><span>
</span><a name="line-135"></a><span class="hs-comment">--   their first use. The result of this function is pure, and can be reused.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">cmdArgsMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254265"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679254265"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254265"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><a name="cmdArgsMode"><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode"><span class="hs-identifier">cmdArgsMode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsCapture"><span class="hs-identifier hs-var">cmdArgsCapture</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#capture"><span class="hs-identifier hs-var">capture</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- | Take purely annotated records and turn them in to a 'Mode' value, that can</span><span>
</span><a name="line-141"></a><span class="hs-comment">--   make use of the &quot;System.Console.CmdArgs.Explicit&quot; functions (i.e. 'process').</span><span>
</span><a name="line-142"></a><span class="hs-identifier">cmdArgsMode_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254264"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254264"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><a name="cmdArgsMode_"><a href="System.Console.CmdArgs.Implicit.html#cmdArgsMode_"><span class="hs-identifier">cmdArgsMode_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsCapture"><span class="hs-identifier hs-var">cmdArgsCapture</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#capture_"><span class="hs-identifier hs-var">capture_</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Run a Mode structure. This function reads the command line arguments</span><span>
</span><a name="line-147"></a><span class="hs-comment">--   and then performs as follows:</span><span>
</span><a name="line-148"></a><span class="hs-comment">--</span><span>
</span><a name="line-149"></a><span class="hs-comment">--   * If invalid arguments are given, it will display the error message</span><span>
</span><a name="line-150"></a><span class="hs-comment">--     and exit.</span><span>
</span><a name="line-151"></a><span class="hs-comment">--</span><span>
</span><a name="line-152"></a><span class="hs-comment">--   * If @--help@ is given, it will display the help message and exit.</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">--   * If @--version@ is given, it will display the version and exit.</span><span>
</span><a name="line-155"></a><span class="hs-comment">--</span><span>
</span><a name="line-156"></a><span class="hs-comment">--   * In all other circumstances the program will return a value.</span><span>
</span><a name="line-157"></a><span class="hs-comment">--</span><span>
</span><a name="line-158"></a><span class="hs-comment">--   * Additionally, if either @--quiet@ or @--verbose@ is given (see 'verbosity')</span><span>
</span><a name="line-159"></a><span class="hs-comment">--     it will set the verbosity (see 'setVerbosity').</span><span>
</span><a name="line-160"></a><span class="hs-identifier">cmdArgsRun</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254263"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679254263"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-161"></a><a name="cmdArgsRun"><a href="System.Console.CmdArgs.Implicit.html#cmdArgsRun"><span class="hs-identifier">cmdArgsRun</span></a></a><span> </span><a name="local-6989586621679254272"><a href="#local-6989586621679254272"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Implicit.html#cmdArgsApply"><span class="hs-identifier hs-var">cmdArgsApply</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="System.Console.CmdArgs.Explicit.html#processArgs"><span class="hs-identifier hs-var">processArgs</span></a><span> </span><a href="#local-6989586621679254272"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Perform the necessary actions dictated by a 'CmdArgs' structure.</span><span>
</span><a name="line-165"></a><span class="hs-comment">--</span><span>
</span><a name="line-166"></a><span class="hs-comment">--   * If 'cmdArgsHelp' is @Just@, it will display the help message and exit.</span><span>
</span><a name="line-167"></a><span class="hs-comment">--</span><span>
</span><a name="line-168"></a><span class="hs-comment">--   * If 'cmdArgsVersion' is @Just@, it will display the version and exit.</span><span>
</span><a name="line-169"></a><span class="hs-comment">--</span><span>
</span><a name="line-170"></a><span class="hs-comment">--   * In all other circumstances it will return a value.</span><span>
</span><a name="line-171"></a><span class="hs-comment">--</span><span>
</span><a name="line-172"></a><span class="hs-comment">--   * Additionally, if 'cmdArgsVerbosity' is @Just@ (see 'verbosity')</span><span>
</span><a name="line-173"></a><span class="hs-comment">--     it will set the verbosity (see 'setVerbosity').</span><span>
</span><a name="line-174"></a><span class="hs-identifier">cmdArgsApply</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254262"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679254262"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-175"></a><a name="cmdArgsApply"><a href="System.Console.CmdArgs.Implicit.html#cmdArgsApply"><span class="hs-identifier">cmdArgsApply</span></a></a><span> </span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-var">CmdArgs</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679254278"><a href="#local-6989586621679254278"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679254274"><span class="hs-identifier hs-var">cmdArgsHelp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">putStr</span><span> </span><a href="#local-6989586621679254278"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">exitSuccess</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679254279"><a href="#local-6989586621679254279"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679254275"><span class="hs-identifier hs-var">cmdArgsVersion</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">putStr</span><span> </span><a href="#local-6989586621679254279"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">exitSuccess</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-179"></a><span>        </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="System.Console.CmdArgs.Verbosity.html#setVerbosity"><span class="hs-identifier hs-var">setVerbosity</span></a><span> </span><a href="#local-6989586621679254276"><span class="hs-identifier hs-var">cmdArgsVerbosity</span></a><span>
</span><a name="line-180"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679254273"><span class="hs-identifier hs-var">cmdArgsValue</span></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | Produce command line arguments that would generate the given value. This</span><span>
</span><a name="line-184"></a><span class="hs-comment">--   function is useful for taking a value resulting from a command line,</span><span>
</span><a name="line-185"></a><span class="hs-comment">--   modifying it (perhaps changing the value of a flag) and generating fresh</span><span>
</span><a name="line-186"></a><span class="hs-comment">--   command line arguments.</span><span>
</span><a name="line-187"></a><span class="hs-comment">--</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- &gt; forall mode values constructed by cmdArgsMode/cmdArgsMode:</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- &gt; forall args which successfully parse with mode</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- &gt; let x = processValue mode args</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- &gt; processValue mode (cmdArgsReform mode $ fromRight x) == x</span><span>
</span><a name="line-192"></a><span class="hs-identifier">_cmdArgsReform</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254261"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Implicit.Type.html#CmdArgs"><span class="hs-identifier hs-type">CmdArgs</span></a><span> </span><a href="#local-6989586621679254261"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-193"></a><a name="_cmdArgsReform"><a href="System.Console.CmdArgs.Implicit.html#_cmdArgsReform"><span class="hs-identifier">_cmdArgsReform</span></a></a><span> </span><a name="local-6989586621679254280"><a href="#local-6989586621679254280"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679254281"><a href="#local-6989586621679254281"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679254282"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">modeReform</span><span> </span><a href="#local-6989586621679254280"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679254281"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-194"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679254282"><a href="#local-6989586621679254282"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;System.Console.CmdArgs.Implicit.cmdArgsReform: cannot reform the arguments, perhaps the mode was not &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-195"></a><span>                </span><span class="hs-string">&quot;generated by cmdArgsMode/cmdArgsMode_ ?&quot;</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">-- | Modes: \&quot;I want a program with multiple modes, like darcs or cabal.\&quot;</span><span>
</span><a name="line-199"></a><span class="hs-comment">--</span><span>
</span><a name="line-200"></a><span class="hs-comment">--   Takes a list of modes, and creates a mode which includes them all.</span><span>
</span><a name="line-201"></a><span class="hs-comment">--   If you want one of the modes to be chosen by default, see 'auto'.</span><span>
</span><a name="line-202"></a><span class="hs-comment">--</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- &gt; data Modes = Mode1 | Mode2 | Mode3 deriving Data</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- &gt; cmdArgs $ modes [Mode1,Mode2,Mode3]</span><span>
</span><a name="line-205"></a><span class="hs-identifier">modes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254260"><span class="hs-identifier hs-type">val</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679254260"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679254260"><span class="hs-identifier hs-type">val</span></a><span>
</span><a name="line-206"></a><a name="modes"><a href="System.Console.CmdArgs.Implicit.html#modes"><span class="hs-identifier">modes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#many"><span class="hs-identifier hs-var">many</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- | Flag: \&quot;I want several different flags to set this one field to different values.\&quot;</span><span>
</span><a name="line-209"></a><span class="hs-comment">--</span><span>
</span><a name="line-210"></a><span class="hs-comment">--   This annotation takes a type which is an enumeration, and provides multiple</span><span>
</span><a name="line-211"></a><span class="hs-comment">--   separate flags to set the field to each value. The first element in the list</span><span>
</span><a name="line-212"></a><span class="hs-comment">--   is used as the value of the field.</span><span>
</span><a name="line-213"></a><span class="hs-comment">--</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- &gt; data State = On | Off deriving Data</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- &gt; data Mode = Mode {state :: State}</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- &gt; cmdArgs $ Mode {state = enum [On &amp;= help &quot;Turn on&quot;,Off &amp;= help &quot;Turn off&quot;]}</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- &gt;   --on   Turn on</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- &gt;   --off  Turn off</span><span>
</span><a name="line-219"></a><span class="hs-comment">--</span><span>
</span><a name="line-220"></a><span class="hs-comment">--   This annotation can be used to allow multiple flags within a field:</span><span>
</span><a name="line-221"></a><span class="hs-comment">--</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- &gt; data Mode = Mode {state :: [State]}</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- &gt; cmdArgs $ Mode {state = enum [[] &amp;= ignore, [On] &amp;= help &quot;Turn on&quot;, [Off] &amp;= help &quot;Turn off&quot;]}</span><span>
</span><a name="line-224"></a><span class="hs-comment">--</span><span>
</span><a name="line-225"></a><span class="hs-comment">--   Now @--on --off@ would produce @Mode [On,Off]@.</span><span>
</span><a name="line-226"></a><span class="hs-identifier">enum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254259"><span class="hs-identifier hs-type">val</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679254259"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679254259"><span class="hs-identifier hs-type">val</span></a><span>
</span><a name="line-227"></a><a name="enum"><a href="System.Console.CmdArgs.Implicit.html#enum"><span class="hs-identifier">enum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#many"><span class="hs-identifier hs-var">many</span></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | Add an annotation to a value. Note that if the value is evaluated</span><span>
</span><a name="line-231"></a><span class="hs-comment">--   more than once the annotation will only be available the first time.</span><span>
</span><a name="line-232"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&amp;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-233"></a><span class="hs-special">(</span><span class="hs-operator">&amp;=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254258"><span class="hs-identifier hs-type">val</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679254258"><span class="hs-identifier hs-type">val</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679254258"><span class="hs-identifier hs-type">val</span></a><span>
</span><a name="line-234"></a><span class="hs-special">(</span><a name="%26%3D"><a href="System.Console.CmdArgs.Implicit.html#%26%3D"><span class="hs-operator">&amp;=</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%26%3D"><span class="hs-operator hs-var">A.&amp;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- | Like 'enum', but using the pure annotations.</span><span>
</span><a name="line-238"></a><span class="hs-identifier">enum_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254256"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="#local-6989586621679254257"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679254256"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679254257"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span>
</span><a name="line-239"></a><a name="enum_"><a href="System.Console.CmdArgs.Implicit.html#enum_"><span class="hs-identifier">enum_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="System.Console.CmdArgs.Annotate.html#%3A%3D%2B"><span class="hs-operator hs-var">:=+</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | Like 'modes', but using the pure annotations.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">modes_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#Annotate"><span class="hs-identifier hs-type">Annotate</span></a><span> </span><a href="System.Console.CmdArgs.Implicit.Ann.html#Ann"><span class="hs-identifier hs-type">Ann</span></a><span>
</span><a name="line-243"></a><a name="modes_"><a href="System.Console.CmdArgs.Implicit.html#modes_"><span class="hs-identifier">modes_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.CmdArgs.Annotate.html#many_"><span class="hs-identifier hs-var">many_</span></a><span>
</span><a name="line-244"></a></pre></body></html>