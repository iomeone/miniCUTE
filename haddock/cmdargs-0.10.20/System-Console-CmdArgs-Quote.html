<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>System.Console.CmdArgs.Quote</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/System.Console.CmdArgs.Quote.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cmdargs-0.10.20: Command line argument processing</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">System.Console.CmdArgs.Quote</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Template Haskell quotation function</a></li><li><a href="#g:2">Stub versions of the impure annotations</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides a quotation feature to let you write command line
   arguments in the impure style, but have them translated into the pure style,
   as per <a href="System-Console-CmdArgs-Implicit.html">System.Console.CmdArgs.Implicit</a>. An example:</p><pre>{-# LANGUAGE TemplateHaskell, DeriveDataTypeable, MagicHash #-}
import System.Console.CmdArgs.Implicit
import System.Console.CmdArgs.Quote

data Sample = Sample {hello :: String} deriving (Show, Data, Typeable)

$(cmdArgsQuote [d|
    sample = Sample{hello = def &amp;=# help &quot;World argument&quot; &amp;=# opt &quot;world&quot;}
                   &amp;=# summary &quot;Sample v1&quot;

    run = cmdArgs# sample :: IO Sample
    |])

main = print =&lt;&lt; run</pre><p>Inside <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code> you supply the command line parser using attributes in the
   impure style. If you run with <code>-ddump-splices</code> (to see the Template Haskell output),
   you would see:</p><pre>run = cmdArgs_
    (record Sample{} [hello := def += help &quot;World argument&quot; += opt &quot;world&quot;]
        += summary &quot;Sample v1&quot;)
    :: IO Sample</pre><p><em>Stubs</em></p><p>To define the original parser you may use either the standard impure annotations ('(&amp;=)', <code><a href="System-Console-CmdArgs-Implicit.html#v:modes" title="System.Console.CmdArgs.Implicit">modes</a></code>), or
   the stub annotations versions defined in this module ('(&amp;=#)', <code><a href="System-Console-CmdArgs-Implicit.html#v:modes" title="System.Console.CmdArgs.Implicit">modes</a></code>). The stub versions do not include
   a <a href="Data.html">Data</a> constraint, so can be used in situations where the Data instance is not yet available - typically
   when defining the parser in the same module as the data type on GHC 7.2 and above. The stub versions should
   never be used outside <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code> and will always raise an error.</p><p><em>Explicit types</em></p><p>There will be a limited number of situations where an impure parser will require additional types, typically
   on the result of <code><a href="System-Console-CmdArgs-Implicit.html#v:cmdArgs" title="System.Console.CmdArgs.Implicit">cmdArgs</a></code> if the result is used without a fixed type - for example if you <code><a href="../base-4.12.0.0/Text-Show.html#v:show" title="Text.Show">show</a></code> it. Most users
   will not need to add any types. In some cases you may need to remove some explicit types, where the intermediate
   type of the annotations has changed - but again, this change should be rare.</p><p><em>Completeness</em></p><p>The translation is not complete, although works for all practical instances I've tried. The translation works
   by first expanding out the expression (inlining every function defined within the quote, inlining let bindings),
   then performs the translation. This scheme leads to two consequences: 1) Any expensive computation executed inside
   the quotation to produce the command line flags may be duplicated (a very unlikely scenario). 2) As I do not yet
   have expansion rules for all possible expressions, the expansion (and subsequently the translation) may fail.
   I am interested in any bug reports where the feature does not work as intended.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:cmdArgsQuote">cmdArgsQuote</a> :: <a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] -&gt; <a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:-38--61--35-">(&amp;=#)</a> :: a -&gt; <a href="System-Console-CmdArgs-Implicit.html#t:Ann" title="System.Console.CmdArgs.Implicit">Ann</a> -&gt; a</li><li class="src short"><a href="#v:modes-35-">modes#</a> :: [a] -&gt; a</li><li class="src short"><a href="#v:cmdArgsMode-35-">cmdArgsMode#</a> :: a -&gt; <a href="System-Console-CmdArgs-Explicit.html#t:Mode" title="System.Console.CmdArgs.Explicit">Mode</a> (<a href="System-Console-CmdArgs-Implicit.html#t:CmdArgs" title="System.Console.CmdArgs.Implicit">CmdArgs</a> a)</li><li class="src short"><a href="#v:cmdArgs-35-">cmdArgs#</a> :: a -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> a</li><li class="src short"><a href="#v:enum-35-">enum#</a> :: [a] -&gt; a</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Template Haskell quotation function</h1></a><div class="top"><p class="src"><a id="v:cmdArgsQuote" class="def">cmdArgsQuote</a> :: <a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] -&gt; <a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.14.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/System.Console.CmdArgs.Quote.html#cmdArgsQuote" class="link">Source</a> <a href="#v:cmdArgsQuote" class="selflink">#</a></p><div class="doc"><p>Quotation function to turn an impure version of <a href="System-Console-CmdArgs-Implicit.html">System.Console.CmdArgs.Implicit</a> into a pure one.
   For details see <a href="System-Console-CmdArgs-Quote.html">System.Console.CmdArgs.Quote</a>.</p></div></div><a href="#g:2" id="g:2"><h1>Stub versions of the impure annotations</h1></a><div class="top"><p class="src"><a id="v:-38--61--35-" class="def">(&amp;=#)</a> :: a -&gt; <a href="System-Console-CmdArgs-Implicit.html#t:Ann" title="System.Console.CmdArgs.Implicit">Ann</a> -&gt; a <a href="src/System.Console.CmdArgs.Quote.html#%26%3D%23" class="link">Source</a> <a href="#v:-38--61--35-" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="System-Console-CmdArgs-Implicit.html#v:-38--61-" title="System.Console.CmdArgs.Implicit">&amp;=</a></code> without a <code><a href="System-Console-CmdArgs-Implicit.html#t:Data" title="System.Console.CmdArgs.Implicit">Data</a></code> context, only to be used within <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:modes-35-" class="def">modes#</a> :: [a] -&gt; a <a href="src/System.Console.CmdArgs.Quote.html#modes%23" class="link">Source</a> <a href="#v:modes-35-" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="System-Console-CmdArgs-Implicit.html#v:modes" title="System.Console.CmdArgs.Implicit">modes</a></code> without a <code><a href="System-Console-CmdArgs-Implicit.html#t:Data" title="System.Console.CmdArgs.Implicit">Data</a></code> context, only to be used within <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:cmdArgsMode-35-" class="def">cmdArgsMode#</a> :: a -&gt; <a href="System-Console-CmdArgs-Explicit.html#t:Mode" title="System.Console.CmdArgs.Explicit">Mode</a> (<a href="System-Console-CmdArgs-Implicit.html#t:CmdArgs" title="System.Console.CmdArgs.Implicit">CmdArgs</a> a) <a href="src/System.Console.CmdArgs.Quote.html#cmdArgsMode%23" class="link">Source</a> <a href="#v:cmdArgsMode-35-" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="System-Console-CmdArgs-Implicit.html#v:cmdArgsMode" title="System.Console.CmdArgs.Implicit">cmdArgsMode</a></code> without a <code><a href="System-Console-CmdArgs-Implicit.html#t:Data" title="System.Console.CmdArgs.Implicit">Data</a></code> context, only to be used within <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:cmdArgs-35-" class="def">cmdArgs#</a> :: a -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/System.Console.CmdArgs.Quote.html#cmdArgs%23" class="link">Source</a> <a href="#v:cmdArgs-35-" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="System-Console-CmdArgs-Implicit.html#v:cmdArgs" title="System.Console.CmdArgs.Implicit">cmdArgs</a></code> without a <code><a href="System-Console-CmdArgs-Implicit.html#t:Data" title="System.Console.CmdArgs.Implicit">Data</a></code> context, only to be used within <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:enum-35-" class="def">enum#</a> :: [a] -&gt; a <a href="src/System.Console.CmdArgs.Quote.html#enum%23" class="link">Source</a> <a href="#v:enum-35-" class="selflink">#</a></p><div class="doc"><p>Version of <code><a href="System-Console-CmdArgs-Implicit.html#v:enum" title="System.Console.CmdArgs.Implicit">enum</a></code> without a <code><a href="System-Console-CmdArgs-Implicit.html#t:Data" title="System.Console.CmdArgs.Implicit">Data</a></code> context, only to be used within <code><a href="System-Console-CmdArgs-Quote.html#v:cmdArgsQuote" title="System.Console.CmdArgs.Quote">cmdArgsQuote</a></code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>